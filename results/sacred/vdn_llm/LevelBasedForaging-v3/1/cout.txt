[INFO 02:29:51] pymarl Running command 'my_main'
[INFO 02:29:51] pymarl Started run with ID "1"
[DEBUG 02:29:51] pymarl Starting Heartbeat
[DEBUG 02:29:51] my_main Started
[INFO 02:29:51] my_main Experiment Parameters:
[INFO 02:29:51] my_main 

{   'action_selector': 'epsilon_greedy',
    'add_value_last_step': True,
    'agent': 'rnn',
    'agent_output_type': 'q',
    'batch_size': 10,
    'batch_size_run': 10,
    'buffer_cpu_only': True,
    'buffer_size': 10,
    'checkpoint_path': '',
    'common_reward': True,
    'double_q': True,
    'env': 'posggym',
    'env_args': {   'key': 'LevelBasedForaging-v3',
                    'max_food': 4,
                    'observation_mode': 'tuple',
                    'pretrained_wrapper': None,
                    'seed': 442450749,
                    'size': 10,
                    'time_limit': 100},
    'epsilon_anneal_time': 50000,
    'epsilon_finish': 0.05,
    'epsilon_start': 1.0,
    'evaluate': False,
    'evaluation_epsilon': 0.0,
    'gamma': 0.99,
    'grad_norm_clip': 10,
    'hidden_dim': 64,
    'hypergroup': None,
    'ks_coef_end': 0.1,
    'ks_coef_start': 10.0,
    'ks_duration': 1000000,
    'label': 'default_label',
    'learner': 'q_learner',
    'learner_log_interval': 10000,
    'llm': 'glm',
    'llm_args': {   'key': '885a088fad70c90d664fa7541d6392b3.Mdm3tIwpzF3KHGWF',
                    'model': 'GLM-4-Air',
                    'temperature': 0.7,
                    'top_p': 0.7},
    'llm_cache_path': 'lbf_cache',
    'llm_nretry': 10,
    'llm_nsample': 5,
    'load_step': 0,
    'local_results_path': 'results',
    'log_interval': 50000,
    'lr': 0.0005,
    'mac': 'basic_mac',
    'mixer': 'vdn',
    'name': 'vdn_llm',
    'obs_agent_id': True,
    'obs_individual_obs': False,
    'obs_last_action': False,
    'optim_alpha': 0.99,
    'optim_eps': 1e-05,
    'render': False,
    'repeat_id': 1,
    'reward_scalarisation': 'sum',
    'runner': 'parallel',
    'runner_log_interval': 10000,
    'save_model': True,
    'save_model_interval': 50000,
    'save_replay': False,
    'seed': 442450749,
    'standardise_returns': False,
    'standardise_rewards': True,
    't_max': 1000000,
    'target_update_interval_or_tau': 200,
    'test_greedy': True,
    'test_interval': 50000,
    'test_nepisode': 100,
    'use_cuda': True,
    'use_rnn': False,
    'use_tensorboard': True,
    'use_wandb': False,
    'wandb_mode': 'offline',
    'wandb_project': None,
    'wandb_save_model': False,
    'wandb_team': None}

[INFO 02:29:51] my_main *******************
[INFO 02:29:51] my_main Tensorboard logging dir:
[INFO 02:29:51] my_main /home/wangyida/Repos/epymarl/results/tb_logs/vdn_llm_seed442450749_LevelBasedForaging-v3_2024-09-21 02:29:51.443984
[INFO 02:29:51] my_main *******************
[INFO 02:29:54] my_main Beginning training for 1000000 timesteps
[INFO 02:30:33] my_main t_env: 500 / 1000000
[INFO 02:30:33] my_main Estimated time left: 13 minutes, 3 seconds. Time passed: 39 seconds
[INFO 02:30:38] my_main Saving models to results/models/vdn_llm_seed442450749_LevelBasedForaging-v3_2024-09-21 02:29:51.443984/500
[INFO 03:11:07] my_main Recent Stats | t_env:      50477 | Episode:     1010
ep_length_mean:           49.9781	epsilon:                   0.2309	grad_norm:                 0.6506	kickstart_coef:            9.7942
kickstart_loss:           -0.1751	q_taken_mean:              0.0685	return_mean:               0.1531	return_std:                0.1817
target_mean:               0.0907	td_error_abs:              0.3250	td_loss:                   1.1492	test_ep_length_mean:      50.0000
test_return_mean:          0.0182	test_return_std:           0.0570	
[INFO 03:11:11] my_main t_env: 50977 / 1000000
[INFO 03:11:11] my_main Estimated time left: 12 hours, 43 minutes, 56 seconds. Time passed: 41 minutes, 17 seconds
[INFO 03:11:16] my_main Saving models to results/models/vdn_llm_seed442450749_LevelBasedForaging-v3_2024-09-21 02:29:51.443984/50977
[INFO 03:27:21] my_main Recent Stats | t_env:     100963 | Episode:     2020
ep_length_mean:           49.9867	epsilon:                   0.0500	grad_norm:                 2.1969	kickstart_coef:            9.2935
kickstart_loss:           -0.2181	q_taken_mean:              0.0770	return_mean:               0.1319	return_std:                0.1675
target_mean:               0.0534	td_error_abs:              0.3217	td_loss:                   0.6762	test_ep_length_mean:      50.0000
test_return_mean:          0.0291	test_return_std:           0.0770	
[INFO 03:27:26] my_main t_env: 101463 / 1000000
[INFO 03:27:26] my_main Estimated time left: 4 hours, 49 minutes, 3 seconds. Time passed: 57 minutes, 32 seconds
[INFO 03:27:30] my_main Saving models to results/models/vdn_llm_seed442450749_LevelBasedForaging-v3_2024-09-21 02:29:51.443984/101463
[INFO 03:45:21] my_main Recent Stats | t_env:     151433 | Episode:     3030
ep_length_mean:           49.9714	epsilon:                   0.0500	grad_norm:                 2.5784	kickstart_coef:            8.7947
kickstart_loss:           -0.2645	q_taken_mean:              0.1235	return_mean:               0.1321	return_std:                0.1775
target_mean:               0.0878	td_error_abs:              0.3796	td_loss:                   0.7728	test_ep_length_mean:      50.0000
test_return_mean:          0.0330	test_return_std:           0.0796	
[INFO 03:45:26] my_main t_env: 151933 / 1000000
[INFO 03:45:26] my_main Estimated time left: 5 hours, 2 minutes, 26 seconds. Time passed: 1 hours, 15 minutes, 32 seconds
[INFO 03:45:31] my_main Saving models to results/models/vdn_llm_seed442450749_LevelBasedForaging-v3_2024-09-21 02:29:51.443984/151933
[INFO 04:04:01] my_main Recent Stats | t_env:     201640 | Episode:     4040
ep_length_mean:           49.7848	epsilon:                   0.0500	grad_norm:                 4.3340	kickstart_coef:            8.2917
kickstart_loss:           -0.3346	q_taken_mean:              0.2086	return_mean:               0.1552	return_std:                0.2004
target_mean:               0.1691	td_error_abs:              0.6111	td_loss:                   1.2194	test_ep_length_mean:      50.0000
test_return_mean:          0.0457	test_return_std:           0.0961	
[INFO 04:04:16] my_main t_env: 202140 / 1000000
[INFO 04:04:16] my_main Estimated time left: 4 hours, 59 minutes, 24 seconds. Time passed: 1 hours, 34 minutes, 22 seconds
[INFO 04:04:21] my_main Saving models to results/models/vdn_llm_seed442450749_LevelBasedForaging-v3_2024-09-21 02:29:51.443984/202140
[INFO 04:27:18] my_main Recent Stats | t_env:     251796 | Episode:     5050
ep_length_mean:           49.6467	epsilon:                   0.0500	grad_norm:                 3.8315	kickstart_coef:            7.7776
kickstart_loss:           -0.3480	q_taken_mean:              0.2605	return_mean:               0.2177	return_std:                0.2340
target_mean:               0.2966	td_error_abs:              0.4963	td_loss:                   1.2390	test_ep_length_mean:      50.0000
test_return_mean:          0.0614	test_return_std:           0.1149	
[INFO 04:27:23] my_main t_env: 252296 / 1000000
[INFO 04:27:23] my_main Estimated time left: 5 hours, 44 minutes, 28 seconds. Time passed: 1 hours, 57 minutes, 28 seconds
[INFO 04:27:27] my_main Saving models to results/models/vdn_llm_seed442450749_LevelBasedForaging-v3_2024-09-21 02:29:51.443984/252296
[INFO 04:43:57] my_main Recent Stats | t_env:     302081 | Episode:     6070
ep_length_mean:           49.3543	epsilon:                   0.0500	grad_norm:                 4.5457	kickstart_coef:            7.2632
kickstart_loss:           -0.4030	q_taken_mean:              0.4859	return_mean:               0.2407	return_std:                0.2525
target_mean:               0.4615	td_error_abs:              0.6460	td_loss:                   1.4037	test_ep_length_mean:      49.9140
test_return_mean:          0.1006	test_return_std:           0.1479	
[INFO 04:44:20] my_main t_env: 302581 / 1000000
[INFO 04:44:20] my_main Estimated time left: 3 hours, 55 minutes, 6 seconds. Time passed: 2 hours, 14 minutes, 26 seconds
[INFO 04:44:24] my_main Saving models to results/models/vdn_llm_seed442450749_LevelBasedForaging-v3_2024-09-21 02:29:51.443984/302581
[INFO 05:02:03] my_main Recent Stats | t_env:     352480 | Episode:     7090
ep_length_mean:           49.4333	epsilon:                   0.0500	grad_norm:                 3.8851	kickstart_coef:            6.7492
kickstart_loss:           -0.4041	q_taken_mean:              0.3955	return_mean:               0.2516	return_std:                0.2486
target_mean:               0.4104	td_error_abs:              0.5213	td_loss:                   1.1789	test_ep_length_mean:      49.9140
test_return_mean:          0.1315	test_return_std:           0.1699	
[INFO 05:02:07] my_main t_env: 352938 / 1000000
[INFO 05:02:07] my_main Estimated time left: 3 hours, 48 minutes, 36 seconds. Time passed: 2 hours, 32 minutes, 13 seconds
[INFO 05:02:12] my_main Saving models to results/models/vdn_llm_seed442450749_LevelBasedForaging-v3_2024-09-21 02:29:51.443984/352938
[INFO 05:22:07] my_main Recent Stats | t_env:     402611 | Episode:     8110
ep_length_mean:           49.0933	epsilon:                   0.0500	grad_norm:                 3.3952	kickstart_coef:            6.2384
kickstart_loss:           -0.4065	q_taken_mean:              0.3748	return_mean:               0.2646	return_std:                0.2590
target_mean:               0.3592	td_error_abs:              0.5039	td_loss:                   0.9998	test_ep_length_mean:      49.5520
test_return_mean:          0.1719	test_return_std:           0.2098	
[INFO 05:22:12] my_main t_env: 403111 / 1000000
[INFO 05:22:12] my_main Estimated time left: 3 hours, 58 minutes, 59 seconds. Time passed: 2 hours, 52 minutes, 18 seconds
[INFO 05:22:17] my_main Saving models to results/models/vdn_llm_seed442450749_LevelBasedForaging-v3_2024-09-21 02:29:51.443984/403111
[INFO 05:41:30] my_main Recent Stats | t_env:     453093 | Episode:     9140
ep_length_mean:           49.0467	epsilon:                   0.0500	grad_norm:                 4.9334	kickstart_coef:            5.7283
kickstart_loss:           -0.4235	q_taken_mean:              0.4381	return_mean:               0.2601	return_std:                0.2627
target_mean:               0.4826	td_error_abs:              0.5666	td_loss:                   1.4810	test_ep_length_mean:      49.3760
test_return_mean:          0.2015	test_return_std:           0.2271	
[INFO 05:41:45] my_main t_env: 453593 / 1000000
[INFO 05:41:45] my_main Estimated time left: 3 hours, 31 minutes, 33 seconds. Time passed: 3 hours, 11 minutes, 51 seconds
[INFO 05:41:50] my_main Saving models to results/models/vdn_llm_seed442450749_LevelBasedForaging-v3_2024-09-21 02:29:51.443984/453593
[INFO 06:03:03] my_main Recent Stats | t_env:     503319 | Episode:    10170
ep_length_mean:           48.7705	epsilon:                   0.0500	grad_norm:                 2.6922	kickstart_coef:            5.2199
kickstart_loss:           -0.4135	q_taken_mean:              0.3865	return_mean:               0.2730	return_std:                0.2789
target_mean:               0.3795	td_error_abs:              0.5567	td_loss:                   1.1624	test_ep_length_mean:      49.1000
test_return_mean:          0.2232	test_return_std:           0.2431	
[INFO 06:03:08] my_main t_env: 503819 / 1000000
[INFO 06:03:08] my_main Estimated time left: 3 hours, 31 minutes, 16 seconds. Time passed: 3 hours, 33 minutes, 14 seconds
[INFO 06:03:14] my_main Saving models to results/models/vdn_llm_seed442450749_LevelBasedForaging-v3_2024-09-21 02:29:51.443984/503819
[INFO 06:25:00] my_main Recent Stats | t_env:     553396 | Episode:    11200
ep_length_mean:           48.6210	epsilon:                   0.0500	grad_norm:                 5.3588	kickstart_coef:            4.8146
kickstart_loss:           -0.4356	q_taken_mean:              0.5567	return_mean:               0.2841	return_std:                0.2827
target_mean:               0.4871	td_error_abs:              0.6362	td_loss:                   1.1850	test_ep_length_mean:      49.0340
test_return_mean:          0.2290	test_return_std:           0.2489	
[INFO 06:25:05] my_main t_env: 553884 / 1000000
[INFO 06:25:05] my_main Estimated time left: 3 hours, 15 minutes, 30 seconds. Time passed: 3 hours, 55 minutes, 11 seconds
[INFO 06:25:11] my_main Saving models to results/models/vdn_llm_seed442450749_LevelBasedForaging-v3_2024-09-21 02:29:51.443984/553884
[INFO 06:44:37] my_main Recent Stats | t_env:     603670 | Episode:    12240
ep_length_mean:           48.4200	epsilon:                   0.0500	grad_norm:                 3.9618	kickstart_coef:            4.3101
kickstart_loss:           -0.3612	q_taken_mean:              0.4291	return_mean:               0.3056	return_std:                0.2934
target_mean:               0.4255	td_error_abs:              0.5499	td_loss:                   1.0765	test_ep_length_mean:      48.9140
test_return_mean:          0.2368	test_return_std:           0.2595	
[INFO 06:44:43] my_main t_env: 604170 / 1000000
[INFO 06:44:43] my_main Estimated time left: 2 hours, 34 minutes, 34 seconds. Time passed: 4 hours, 14 minutes, 49 seconds
[INFO 06:44:49] my_main Saving models to results/models/vdn_llm_seed442450749_LevelBasedForaging-v3_2024-09-21 02:29:51.443984/604170
[INFO 07:07:04] my_main Recent Stats | t_env:     654006 | Episode:    13280
ep_length_mean:           48.5390	epsilon:                   0.0500	grad_norm:                 2.2882	kickstart_coef:            3.8073
kickstart_loss:           -0.3769	q_taken_mean:              0.4694	return_mean:               0.2950	return_std:                0.2843
target_mean:               0.4820	td_error_abs:              0.5227	td_loss:                   1.0801	test_ep_length_mean:      49.0540
test_return_mean:          0.2340	test_return_std:           0.2550	
[INFO 07:07:20] my_main t_env: 654506 / 1000000
[INFO 07:07:20] my_main Estimated time left: 2 hours, 35 minutes, 13 seconds. Time passed: 4 hours, 37 minutes, 26 seconds
[INFO 07:07:26] my_main Saving models to results/models/vdn_llm_seed442450749_LevelBasedForaging-v3_2024-09-21 02:29:51.443984/654506
[INFO 07:28:38] my_main Recent Stats | t_env:     704291 | Episode:    14320
ep_length_mean:           48.2895	epsilon:                   0.0500	grad_norm:                 4.0896	kickstart_coef:            3.3047
kickstart_loss:           -0.3505	q_taken_mean:              0.4179	return_mean:               0.3103	return_std:                0.2998
target_mean:               0.4568	td_error_abs:              0.4362	td_loss:                   0.8372	test_ep_length_mean:      48.8320
test_return_mean:          0.2419	test_return_std:           0.2684	
[INFO 07:28:45] my_main t_env: 704791 / 1000000
[INFO 07:28:45] my_main Estimated time left: 2 hours, 5 minutes, 44 seconds. Time passed: 4 hours, 58 minutes, 51 seconds
[INFO 07:28:52] my_main Saving models to results/models/vdn_llm_seed442450749_LevelBasedForaging-v3_2024-09-21 02:29:51.443984/704791
[INFO 07:53:05] my_main Recent Stats | t_env:     754332 | Episode:    15350
ep_length_mean:           48.4781	epsilon:                   0.0500	grad_norm:                 5.4192	kickstart_coef:            2.8013
kickstart_loss:           -0.3994	q_taken_mean:              0.7733	return_mean:               0.2975	return_std:                0.2938
target_mean:               0.7492	td_error_abs:              0.5416	td_loss:                   0.9914	test_ep_length_mean:      48.8300
test_return_mean:          0.2535	test_return_std:           0.2684	
[INFO 07:53:15] my_main t_env: 754832 / 1000000
[INFO 07:53:15] my_main Estimated time left: 2 hours, 1 seconds. Time passed: 5 hours, 23 minutes, 21 seconds
[INFO 07:53:22] my_main Saving models to results/models/vdn_llm_seed442450749_LevelBasedForaging-v3_2024-09-21 02:29:51.443984/754832
[INFO 08:20:20] my_main Recent Stats | t_env:     804384 | Episode:    16380
ep_length_mean:           48.6181	epsilon:                   0.0500	grad_norm:                 5.1369	kickstart_coef:            2.2956
kickstart_loss:           -0.3333	q_taken_mean:              0.6065	return_mean:               0.3059	return_std:                0.2888
target_mean:               0.5840	td_error_abs:              0.4866	td_loss:                   0.9212	test_ep_length_mean:      48.7680
test_return_mean:          0.2583	test_return_std:           0.2740	
[INFO 08:20:38] my_main t_env: 805305 / 1000000
[INFO 08:20:38] my_main Estimated time left: 1 hours, 45 minutes, 39 seconds. Time passed: 5 hours, 50 minutes, 44 seconds
[INFO 08:20:45] my_main Saving models to results/models/vdn_llm_seed442450749_LevelBasedForaging-v3_2024-09-21 02:29:51.443984/805305
[INFO 08:45:13] my_main Recent Stats | t_env:     854447 | Episode:    17420
ep_length_mean:           48.2162	epsilon:                   0.0500	grad_norm:                 3.9697	kickstart_coef:            1.7941
kickstart_loss:           -0.3178	q_taken_mean:              0.5526	return_mean:               0.3119	return_std:                0.2953
target_mean:               0.5679	td_error_abs:              0.4054	td_loss:                   0.7203	test_ep_length_mean:      48.6000
test_return_mean:          0.2690	test_return_std:           0.2767	
[INFO 08:46:10] my_main t_env: 855353 / 1000000
[INFO 08:46:10] my_main Estimated time left: 1 hours, 13 minutes, 46 seconds. Time passed: 6 hours, 16 minutes, 16 seconds
[INFO 08:46:17] my_main Saving models to results/models/vdn_llm_seed442450749_LevelBasedForaging-v3_2024-09-21 02:29:51.443984/855353
[INFO 09:13:43] my_main Recent Stats | t_env:     904738 | Episode:    18460
ep_length_mean:           48.3295	epsilon:                   0.0500	grad_norm:                 5.1493	kickstart_coef:            1.2913
kickstart_loss:           -0.2797	q_taken_mean:              0.7400	return_mean:               0.3183	return_std:                0.2953
target_mean:               0.7585	td_error_abs:              0.4566	td_loss:                   0.9327	test_ep_length_mean:      48.6600
test_return_mean:          0.2757	test_return_std:           0.2767	
[INFO 09:14:02] my_main t_env: 905705 / 1000000
[INFO 09:14:02] my_main Estimated time left: 52 minutes, 10 seconds. Time passed: 6 hours, 44 minutes, 7 seconds
[INFO 09:14:08] my_main Saving models to results/models/vdn_llm_seed442450749_LevelBasedForaging-v3_2024-09-21 02:29:51.443984/905705
[INFO 09:43:31] my_main Recent Stats | t_env:     954871 | Episode:    19500
ep_length_mean:           48.1390	epsilon:                   0.0500	grad_norm:                 4.3515	kickstart_coef:            0.7895
kickstart_loss:           -0.2521	q_taken_mean:              0.7983	return_mean:               0.3111	return_std:                0.2965
target_mean:               0.7896	td_error_abs:              0.4184	td_loss:                   0.9145	test_ep_length_mean:      48.7160
test_return_mean:          0.2708	test_return_std:           0.2717	
[INFO 09:44:15] my_main t_env: 955749 / 1000000
[INFO 09:44:15] my_main Estimated time left: 26 minutes, 43 seconds. Time passed: 7 hours, 14 minutes, 20 seconds
[INFO 09:44:21] my_main Saving models to results/models/vdn_llm_seed442450749_LevelBasedForaging-v3_2024-09-21 02:29:51.443984/955749
[INFO 10:06:30] my_main Finished Training
Process Process-11:
Process Process-9:
Process Process-5:
Process Process-10:
Process Process-8:
Process Process-6:
Process Process-2:
Process Process-4:
Process Process-3:
Process Process-7:
Exiting Main
Stopping all threads
Thread Thread-1 is alive! Is daemon: False
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/wangyida/Repos/epymarl/src/runners/parallel_runner.py", line 371, in env_worker
    teacher.close()
Traceback (most recent call last):
  File "/home/wangyida/Repos/epymarl/src/teachers/teacher.py", line 37, in close
    self.planner.close()
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 71, in close
    self.cache.sync()
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 103, in sync
    storage.update(self.cache)
  File "<string>", line 2, in keys
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
    kind, result = conn.recv()
                   ^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
          ^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
    buf = self._recv(4)
          ^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
    chunk = read(handle, remaining)
            ^^^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [Errno 104] Connection reset by peer
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/wangyida/Repos/epymarl/src/runners/parallel_runner.py", line 371, in env_worker
    teacher.close()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/wangyida/Repos/epymarl/src/runners/parallel_runner.py", line 371, in env_worker
    teacher.close()
  File "/home/wangyida/Repos/epymarl/src/runners/parallel_runner.py", line 371, in env_worker
    teacher.close()
  File "/home/wangyida/Repos/epymarl/src/teachers/teacher.py", line 37, in close
    self.planner.close()
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 71, in close
    self.cache.sync()
  File "/home/wangyida/Repos/epymarl/src/teachers/teacher.py", line 37, in close
    self.planner.close()
  File "/home/wangyida/Repos/epymarl/src/teachers/teacher.py", line 37, in close
    self.planner.close()
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 103, in sync
    storage.update(self.cache)
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 71, in close
    self.cache.sync()
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 71, in close
    self.cache.sync()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 103, in sync
    storage.update(self.cache)
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 103, in sync
    storage.update(self.cache)
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "<string>", line 2, in keys
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "<string>", line 2, in keys
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
    kind, result = conn.recv()
                   ^^^^^^^^^^^
  File "<string>", line 2, in keys
  File "/home/wangyida/Repos/epymarl/src/runners/parallel_runner.py", line 371, in env_worker
    teacher.close()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/wangyida/Repos/epymarl/src/runners/parallel_runner.py", line 371, in env_worker
    teacher.close()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
          ^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
    kind, result = conn.recv()
                   ^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
    kind, result = conn.recv()
                   ^^^^^^^^^^^
  File "/home/wangyida/Repos/epymarl/src/runners/parallel_runner.py", line 371, in env_worker
    teacher.close()
  File "/home/wangyida/Repos/epymarl/src/teachers/teacher.py", line 37, in close
    self.planner.close()
  File "/home/wangyida/Repos/epymarl/src/teachers/teacher.py", line 37, in close
    self.planner.close()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
    buf = self._recv(4)
          ^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
          ^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
          ^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 71, in close
    self.cache.sync()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/wangyida/Repos/epymarl/src/teachers/teacher.py", line 37, in close
    self.planner.close()
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 71, in close
    self.cache.sync()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
    chunk = read(handle, remaining)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
    buf = self._recv(4)
          ^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
    buf = self._recv(4)
          ^^^^^^^^^^^^^
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 103, in sync
    storage.update(self.cache)
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 71, in close
    self.cache.sync()
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 103, in sync
    storage.update(self.cache)
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
    chunk = read(handle, remaining)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
    chunk = read(handle, remaining)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 103, in sync
    storage.update(self.cache)
  File "/home/wangyida/Repos/epymarl/src/runners/parallel_runner.py", line 371, in env_worker
    teacher.close()
  File "<string>", line 2, in keys
  File "<string>", line 2, in keys
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "<string>", line 2, in keys
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
    kind, result = conn.recv()
                   ^^^^^^^^^^^
  File "/home/wangyida/Repos/epymarl/src/teachers/teacher.py", line 37, in close
    self.planner.close()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
    kind, result = conn.recv()
                   ^^^^^^^^^^^
ConnectionResetError: [Errno 104] Connection reset by peer
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
          ^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
    kind, result = conn.recv()
                   ^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 71, in close
    self.cache.sync()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
          ^^^^^^^^^^^^^^^^^^
ConnectionResetError: [Errno 104] Connection reset by peer
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
    buf = self._recv(4)
          ^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
          ^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 103, in sync
    storage.update(self.cache)
  File "/home/wangyida/Repos/epymarl/src/runners/parallel_runner.py", line 371, in env_worker
    teacher.close()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
    buf = self._recv(4)
          ^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
    chunk = read(handle, remaining)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
    buf = self._recv(4)
          ^^^^^^^^^^^^^
ConnectionResetError: [Errno 104] Connection reset by peer
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
    chunk = read(handle, remaining)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/Repos/epymarl/src/teachers/teacher.py", line 37, in close
    self.planner.close()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
    chunk = read(handle, remaining)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in keys
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 71, in close
    self.cache.sync()
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 103, in sync
    storage.update(self.cache)
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
    kind, result = conn.recv()
                   ^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
          ^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
    buf = self._recv(4)
          ^^^^^^^^^^^^^
  File "<string>", line 2, in keys
ConnectionResetError: [Errno 104] Connection reset by peer
ConnectionResetError: [Errno 104] Connection reset by peer
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
    chunk = read(handle, remaining)
            ^^^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [Errno 104] Connection reset by peer
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
    kind, result = conn.recv()
                   ^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
          ^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
    buf = self._recv(4)
          ^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
    chunk = read(handle, remaining)
            ^^^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [Errno 104] Connection reset by peer
ConnectionResetError: [Errno 104] Connection reset by peer
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/wangyida/Repos/epymarl/src/runners/parallel_runner.py", line 371, in env_worker
    teacher.close()
  File "/home/wangyida/Repos/epymarl/src/teachers/teacher.py", line 37, in close
    self.planner.close()
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 71, in close
    self.cache.sync()
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 103, in sync
    storage.update(self.cache)
  File "<string>", line 2, in keys
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
    kind, result = conn.recv()
                   ^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
          ^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
    buf = self._recv(4)
          ^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
    chunk = read(handle, remaining)
            ^^^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [Errno 104] Connection reset by peer
Thread joined
Exiting script
[DEBUG 10:06:31] my_main Finished after 7:36:40.
[INFO 10:06:31] pymarl Completed after 7:36:40
