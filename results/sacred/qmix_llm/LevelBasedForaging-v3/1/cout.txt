[INFO 02:29:44] pymarl Running command 'my_main'
[INFO 02:29:44] pymarl Started run with ID "1"
[DEBUG 02:29:44] pymarl Starting Heartbeat
[DEBUG 02:29:44] my_main Started
[INFO 02:29:44] my_main Experiment Parameters:
[INFO 02:29:44] my_main 

{   'action_selector': 'epsilon_greedy',
    'add_value_last_step': True,
    'agent': 'rnn',
    'agent_output_type': 'q',
    'batch_size': 10,
    'batch_size_run': 10,
    'buffer_cpu_only': True,
    'buffer_size': 10,
    'checkpoint_path': '',
    'common_reward': True,
    'double_q': True,
    'env': 'posggym',
    'env_args': {   'key': 'LevelBasedForaging-v3',
                    'max_food': 4,
                    'observation_mode': 'tuple',
                    'pretrained_wrapper': None,
                    'seed': 60798620,
                    'size': 10,
                    'time_limit': 100},
    'epsilon_anneal_time': 50000,
    'epsilon_finish': 0.05,
    'epsilon_start': 1.0,
    'evaluate': False,
    'evaluation_epsilon': 0.0,
    'gamma': 0.99,
    'grad_norm_clip': 10,
    'hidden_dim': 64,
    'hypergroup': None,
    'hypernet_embed': 64,
    'hypernet_layers': 2,
    'ks_coef_end': 0.1,
    'ks_coef_start': 10.0,
    'ks_duration': 1000000,
    'label': 'default_label',
    'learner': 'q_learner',
    'learner_log_interval': 10000,
    'llm': 'glm',
    'llm_args': {   'key': '885a088fad70c90d664fa7541d6392b3.Mdm3tIwpzF3KHGWF',
                    'model': 'GLM-4-Air',
                    'temperature': 0.7,
                    'top_p': 0.7},
    'llm_cache_path': 'lbf_cache',
    'llm_nretry': 10,
    'llm_nsample': 5,
    'load_step': 0,
    'local_results_path': 'results',
    'log_interval': 50000,
    'lr': 0.0005,
    'mac': 'basic_mac',
    'mixer': 'qmix',
    'mixing_embed_dim': 32,
    'name': 'qmix_llm',
    'obs_agent_id': True,
    'obs_individual_obs': False,
    'obs_last_action': False,
    'optim_alpha': 0.99,
    'optim_eps': 1e-05,
    'render': False,
    'repeat_id': 1,
    'reward_scalarisation': 'sum',
    'runner': 'parallel',
    'runner_log_interval': 10000,
    'save_model': True,
    'save_model_interval': 50000,
    'save_replay': False,
    'seed': 60798620,
    'standardise_returns': False,
    'standardise_rewards': True,
    't_max': 1000000,
    'target_update_interval_or_tau': 200,
    'test_greedy': True,
    'test_interval': 50000,
    'test_nepisode': 100,
    'use_cuda': True,
    'use_rnn': False,
    'use_tensorboard': True,
    'use_wandb': False,
    'wandb_mode': 'offline',
    'wandb_project': None,
    'wandb_save_model': False,
    'wandb_team': None}

[INFO 02:29:44] my_main *******************
[INFO 02:29:44] my_main Tensorboard logging dir:
[INFO 02:29:44] my_main /home/wangyida/Repos/epymarl/results/tb_logs/qmix_llm_seed60798620_LevelBasedForaging-v3_2024-09-21 02:29:44.216202
[INFO 02:29:44] my_main *******************
[INFO 02:29:47] my_main Beginning training for 1000000 timesteps
[INFO 02:29:52] my_main t_env: 500 / 1000000
[INFO 02:29:52] my_main Estimated time left: 1 minutes, 41 seconds. Time passed: 5 seconds
[INFO 02:29:56] my_main Saving models to results/models/qmix_llm_seed60798620_LevelBasedForaging-v3_2024-09-21 02:29:44.216202/500
[INFO 03:24:08] my_main Recent Stats | t_env:      50472 | Episode:     1010
ep_length_mean:           49.9733	epsilon:                   0.2310	grad_norm:                 0.8814	kickstart_coef:            9.7961
kickstart_loss:           -0.1865	q_taken_mean:              0.1204	return_mean:               0.1294	return_std:                0.1622
target_mean:               0.1347	td_error_abs:              0.2234	td_loss:                   1.1061	test_ep_length_mean:      50.0000
test_return_mean:          0.0000	test_return_std:           0.0000	
[INFO 03:24:25] my_main t_env: 50972 / 1000000
[INFO 03:24:25] my_main Estimated time left: 17 hours, 5 minutes, 49 seconds. Time passed: 54 minutes, 38 seconds
[INFO 03:24:31] my_main Saving models to results/models/qmix_llm_seed60798620_LevelBasedForaging-v3_2024-09-21 02:29:44.216202/50972
[INFO 03:39:34] my_main Recent Stats | t_env:     100912 | Episode:     2020
ep_length_mean:           49.9429	epsilon:                   0.0500	grad_norm:                 1.6428	kickstart_coef:            9.2965
kickstart_loss:           -0.2249	q_taken_mean:              0.1032	return_mean:               0.1164	return_std:                0.1589
target_mean:               0.1239	td_error_abs:              0.2311	td_loss:                   1.0697	test_ep_length_mean:      50.0000
test_return_mean:          0.0324	test_return_std:           0.0562	
[INFO 03:39:39] my_main t_env: 101412 / 1000000
[INFO 03:39:39] my_main Estimated time left: 4 hours, 31 minutes, 23 seconds. Time passed: 1 hours, 9 minutes, 52 seconds
[INFO 03:39:44] my_main Saving models to results/models/qmix_llm_seed60798620_LevelBasedForaging-v3_2024-09-21 02:29:44.216202/101412
[INFO 04:00:37] my_main Recent Stats | t_env:     151369 | Episode:     3030
ep_length_mean:           49.9867	epsilon:                   0.0500	grad_norm:                 5.0032	kickstart_coef:            8.7951
kickstart_loss:           -0.3128	q_taken_mean:              0.1489	return_mean:               0.1428	return_std:                0.1790
target_mean:               0.0796	td_error_abs:              0.3197	td_loss:                   0.6318	test_ep_length_mean:      50.0000
test_return_mean:          0.0398	test_return_std:           0.0776	
[INFO 04:01:01] my_main t_env: 151869 / 1000000
[INFO 04:01:01] my_main Estimated time left: 5 hours, 59 minutes, 3 seconds. Time passed: 1 hours, 31 minutes, 14 seconds
[INFO 04:01:06] my_main Saving models to results/models/qmix_llm_seed60798620_LevelBasedForaging-v3_2024-09-21 02:29:44.216202/151869
[INFO 04:22:11] my_main Recent Stats | t_env:     201419 | Episode:     4040
ep_length_mean:           49.6238	epsilon:                   0.0500	grad_norm:                 4.3300	kickstart_coef:            8.2853
kickstart_loss:           -0.4127	q_taken_mean:              0.1042	return_mean:               0.2003	return_std:                0.2207
target_mean:               0.1125	td_error_abs:              0.3259	td_loss:                   1.2502	test_ep_length_mean:      50.0000
test_return_mean:          0.0688	test_return_std:           0.1001	
[INFO 04:22:16] my_main t_env: 201919 / 1000000
[INFO 04:22:16] my_main Estimated time left: 5 hours, 38 minutes, 59 seconds. Time passed: 1 hours, 52 minutes, 29 seconds
[INFO 04:22:22] my_main Saving models to results/models/qmix_llm_seed60798620_LevelBasedForaging-v3_2024-09-21 02:29:44.216202/201919
[INFO 04:42:48] my_main Recent Stats | t_env:     251722 | Episode:     5060
ep_length_mean:           49.2562	epsilon:                   0.0500	grad_norm:                 8.1136	kickstart_coef:            7.7722
kickstart_loss:           -0.4022	q_taken_mean:              0.1731	return_mean:               0.2424	return_std:                0.2501
target_mean:               0.1680	td_error_abs:              0.4387	td_loss:                   1.6741	test_ep_length_mean:      49.9160
test_return_mean:          0.0879	test_return_std:           0.1189	
[INFO 04:43:05] my_main t_env: 252222 / 1000000
[INFO 04:43:05] my_main Estimated time left: 5 hours, 9 minutes, 21 seconds. Time passed: 2 hours, 13 minutes, 18 seconds
[INFO 04:43:10] my_main Saving models to results/models/qmix_llm_seed60798620_LevelBasedForaging-v3_2024-09-21 02:29:44.216202/252222
[INFO 05:02:19] my_main Recent Stats | t_env:     302099 | Episode:     6080
ep_length_mean:           49.4924	epsilon:                   0.0500	grad_norm:                 7.4881	kickstart_coef:            7.2627
kickstart_loss:           -0.4741	q_taken_mean:              0.2078	return_mean:               0.2236	return_std:                0.2318
target_mean:               0.1779	td_error_abs:              0.3655	td_loss:                   0.9194	test_ep_length_mean:      49.6980
test_return_mean:          0.1246	test_return_std:           0.1663	
[INFO 05:02:24] my_main t_env: 302599 / 1000000
[INFO 05:02:24] my_main Estimated time left: 4 hours, 27 minutes, 32 seconds. Time passed: 2 hours, 32 minutes, 37 seconds
[INFO 05:02:31] my_main Saving models to results/models/qmix_llm_seed60798620_LevelBasedForaging-v3_2024-09-21 02:29:44.216202/302599
[INFO 05:20:50] my_main Recent Stats | t_env:     352578 | Episode:     7100
ep_length_mean:           49.4181	epsilon:                   0.0500	grad_norm:                 7.0192	kickstart_coef:            6.7505
kickstart_loss:           -0.5201	q_taken_mean:              0.0901	return_mean:               0.2312	return_std:                0.2396
target_mean:               0.0948	td_error_abs:              0.3144	td_loss:                   0.7906	test_ep_length_mean:      49.6980
test_return_mean:          0.1449	test_return_std:           0.1802	
[INFO 05:21:17] my_main t_env: 353033 / 1000000
[INFO 05:21:17] my_main Estimated time left: 4 hours, 2 minutes, 7 seconds. Time passed: 2 hours, 51 minutes, 30 seconds
[INFO 05:21:23] my_main Saving models to results/models/qmix_llm_seed60798620_LevelBasedForaging-v3_2024-09-21 02:29:44.216202/353033
[INFO 05:42:02] my_main Recent Stats | t_env:     402743 | Episode:     8120
ep_length_mean:           49.2048	epsilon:                   0.0500	grad_norm:                 9.8571	kickstart_coef:            6.2375
kickstart_loss:           -0.4922	q_taken_mean:              0.1713	return_mean:               0.2424	return_std:                0.2543
target_mean:               0.1471	td_error_abs:              0.3443	td_loss:                   0.7823	test_ep_length_mean:      49.6180
test_return_mean:          0.1752	test_return_std:           0.1988	
[INFO 05:42:07] my_main t_env: 403205 / 1000000
[INFO 05:42:07] my_main Estimated time left: 4 hours, 7 minutes, 48 seconds. Time passed: 3 hours, 12 minutes, 20 seconds
[INFO 05:42:13] my_main Saving models to results/models/qmix_llm_seed60798620_LevelBasedForaging-v3_2024-09-21 02:29:44.216202/403205
[INFO 05:59:19] my_main Recent Stats | t_env:     453127 | Episode:     9140
ep_length_mean:           49.4133	epsilon:                   0.0500	grad_norm:                 9.6237	kickstart_coef:            5.7247
kickstart_loss:           -0.4811	q_taken_mean:              0.3048	return_mean:               0.2282	return_std:                0.2387
target_mean:               0.3056	td_error_abs:              0.4755	td_loss:                   1.4246	test_ep_length_mean:      49.3720
test_return_mean:          0.1841	test_return_std:           0.2164	
[INFO 05:59:36] my_main t_env: 453627 / 1000000
[INFO 05:59:36] my_main Estimated time left: 3 hours, 9 minutes, 27 seconds. Time passed: 3 hours, 29 minutes, 49 seconds
[INFO 05:59:42] my_main Saving models to results/models/qmix_llm_seed60798620_LevelBasedForaging-v3_2024-09-21 02:29:44.216202/453627
[INFO 06:16:29] my_main Recent Stats | t_env:     503610 | Episode:    10160
ep_length_mean:           49.4619	epsilon:                   0.0500	grad_norm:                 8.2527	kickstart_coef:            5.3134
kickstart_loss:           -0.4813	q_taken_mean:              0.2675	return_mean:               0.2486	return_std:                0.2438
target_mean:               0.2514	td_error_abs:              0.4062	td_loss:                   1.0346	test_ep_length_mean:      49.0740
test_return_mean:          0.1971	test_return_std:           0.2309	
[INFO 06:16:47] my_main t_env: 504110 / 1000000
[INFO 06:16:47] my_main Estimated time left: 2 hours, 48 minutes, 49 seconds. Time passed: 3 hours, 47 minutes, 0 seconds
[INFO 06:16:53] my_main Saving models to results/models/qmix_llm_seed60798620_LevelBasedForaging-v3_2024-09-21 02:29:44.216202/504110
[INFO 06:39:44] my_main Recent Stats | t_env:     553957 | Episode:    11180
ep_length_mean:           49.4010	epsilon:                   0.0500	grad_norm:                 8.5535	kickstart_coef:            4.8014
kickstart_loss:           -0.4547	q_taken_mean:              0.1310	return_mean:               0.2523	return_std:                0.2453
target_mean:               0.1012	td_error_abs:              0.3403	td_loss:                   0.6710	test_ep_length_mean:      49.2920
test_return_mean:          0.1919	test_return_std:           0.2218	
[INFO 06:40:24] my_main t_env: 554406 / 1000000
[INFO 06:40:24] my_main Estimated time left: 3 hours, 29 minutes, 16 seconds. Time passed: 4 hours, 10 minutes, 37 seconds
[INFO 06:40:31] my_main Saving models to results/models/qmix_llm_seed60798620_LevelBasedForaging-v3_2024-09-21 02:29:44.216202/554406
[INFO 07:02:58] my_main Recent Stats | t_env:     603970 | Episode:    12190
ep_length_mean:           49.5619	epsilon:                   0.0500	grad_norm:                 5.7648	kickstart_coef:            4.2900
kickstart_loss:           -0.4628	q_taken_mean:              0.1464	return_mean:               0.2405	return_std:                0.2442
target_mean:               0.1479	td_error_abs:              0.3002	td_loss:                   0.5338	test_ep_length_mean:      49.1500
test_return_mean:          0.2012	test_return_std:           0.2322	
[INFO 07:03:04] my_main t_env: 604470 / 1000000
[INFO 07:03:04] my_main Estimated time left: 2 hours, 59 minutes, 5 seconds. Time passed: 4 hours, 33 minutes, 17 seconds
[INFO 07:03:11] my_main Saving models to results/models/qmix_llm_seed60798620_LevelBasedForaging-v3_2024-09-21 02:29:44.216202/604470
[INFO 07:23:59] my_main Recent Stats | t_env:     654102 | Episode:    13200
ep_length_mean:           49.5248	epsilon:                   0.0500	grad_norm:                 5.3837	kickstart_coef:            3.7750
kickstart_loss:           -0.4821	q_taken_mean:              0.1044	return_mean:               0.2413	return_std:                0.2389
target_mean:               0.1300	td_error_abs:              0.2739	td_loss:                   0.6159	test_ep_length_mean:      49.1440
test_return_mean:          0.2035	test_return_std:           0.2379	
[INFO 07:24:31] my_main t_env: 654602 / 1000000
[INFO 07:24:31] my_main Estimated time left: 2 hours, 27 minutes, 46 seconds. Time passed: 4 hours, 54 minutes, 44 seconds
[INFO 07:24:38] my_main Saving models to results/models/qmix_llm_seed60798620_LevelBasedForaging-v3_2024-09-21 02:29:44.216202/654602
[INFO 07:50:15] my_main Recent Stats | t_env:     704371 | Episode:    14220
ep_length_mean:           49.3476	epsilon:                   0.0500	grad_norm:                12.5020	kickstart_coef:            3.2613
kickstart_loss:           -0.4124	q_taken_mean:              0.1815	return_mean:               0.2450	return_std:                0.2461
target_mean:               0.1750	td_error_abs:              0.3689	td_loss:                   0.8926	test_ep_length_mean:      49.3140
test_return_mean:          0.2036	test_return_std:           0.2309	
[INFO 07:50:23] my_main t_env: 704871 / 1000000
[INFO 07:50:23] my_main Estimated time left: 2 hours, 31 minutes, 52 seconds. Time passed: 5 hours, 20 minutes, 36 seconds
[INFO 07:50:30] my_main Saving models to results/models/qmix_llm_seed60798620_LevelBasedForaging-v3_2024-09-21 02:29:44.216202/704871
[INFO 08:15:06] my_main Recent Stats | t_env:     754451 | Episode:    15240
ep_length_mean:           49.1171	epsilon:                   0.0500	grad_norm:                 7.1677	kickstart_coef:            2.7498
kickstart_loss:           -0.4726	q_taken_mean:              0.2399	return_mean:               0.2509	return_std:                0.2622
target_mean:               0.2416	td_error_abs:              0.3584	td_loss:                   0.8053	test_ep_length_mean:      49.5520
test_return_mean:          0.2057	test_return_std:           0.2261	
[INFO 08:15:26] my_main t_env: 754951 / 1000000
[INFO 08:15:26] my_main Estimated time left: 2 hours, 2 minutes, 31 seconds. Time passed: 5 hours, 45 minutes, 39 seconds
[INFO 08:15:33] my_main Saving models to results/models/qmix_llm_seed60798620_LevelBasedForaging-v3_2024-09-21 02:29:44.216202/754951
[INFO 08:41:06] my_main Recent Stats | t_env:     804685 | Episode:    16260
ep_length_mean:           49.2314	epsilon:                   0.0500	grad_norm:                 7.1370	kickstart_coef:            2.2383
kickstart_loss:           -0.4802	q_taken_mean:              0.1034	return_mean:               0.2439	return_std:                0.2477
target_mean:               0.0771	td_error_abs:              0.3308	td_loss:                   0.5934	test_ep_length_mean:      49.4760
test_return_mean:          0.2182	test_return_std:           0.2307	
[INFO 08:41:15] my_main t_env: 805185 / 1000000
[INFO 08:41:15] my_main Estimated time left: 1 hours, 40 minutes, 8 seconds. Time passed: 6 hours, 11 minutes, 28 seconds
[INFO 08:41:22] my_main Saving models to results/models/qmix_llm_seed60798620_LevelBasedForaging-v3_2024-09-21 02:29:44.216202/805185
[INFO 09:04:39] my_main Recent Stats | t_env:     854851 | Episode:    17280
ep_length_mean:           49.2371	epsilon:                   0.0500	grad_norm:                 5.8633	kickstart_coef:            1.8284
kickstart_loss:           -0.4911	q_taken_mean:              0.1023	return_mean:               0.2330	return_std:                0.2463
target_mean:               0.1244	td_error_abs:              0.2429	td_loss:                   0.3457	test_ep_length_mean:      49.5300
test_return_mean:          0.2149	test_return_std:           0.2260	
[INFO 09:04:49] my_main t_env: 855351 / 1000000
[INFO 09:04:49] my_main Estimated time left: 1 hours, 7 minutes, 56 seconds. Time passed: 6 hours, 35 minutes, 2 seconds
[INFO 09:04:56] my_main Saving models to results/models/qmix_llm_seed60798620_LevelBasedForaging-v3_2024-09-21 02:29:44.216202/855351
[INFO 09:27:55] my_main Recent Stats | t_env:     904934 | Episode:    18300
ep_length_mean:           49.0581	epsilon:                   0.0500	grad_norm:                11.3437	kickstart_coef:            1.3182
kickstart_loss:           -0.4757	q_taken_mean:              0.2982	return_mean:               0.2631	return_std:                0.2625
target_mean:               0.2888	td_error_abs:              0.4112	td_loss:                   1.0421	test_ep_length_mean:      49.4640
test_return_mean:          0.2095	test_return_std:           0.2206	
[INFO 09:28:04] my_main t_env: 905434 / 1000000
[INFO 09:28:04] my_main Estimated time left: 43 minutes, 54 seconds. Time passed: 6 hours, 58 minutes, 17 seconds
[INFO 09:28:11] my_main Saving models to results/models/qmix_llm_seed60798620_LevelBasedForaging-v3_2024-09-21 02:29:44.216202/905434
[INFO 09:54:03] my_main Recent Stats | t_env:     955240 | Episode:    19320
ep_length_mean:           49.2486	epsilon:                   0.0500	grad_norm:                12.9725	kickstart_coef:            0.8062
kickstart_loss:           -0.5025	q_taken_mean:              0.2663	return_mean:               0.2439	return_std:                0.2458
target_mean:               0.2071	td_error_abs:              0.3970	td_loss:                   0.8506	test_ep_length_mean:      49.3900
test_return_mean:          0.2099	test_return_std:           0.2236	
[INFO 09:54:12] my_main t_env: 955740 / 1000000
[INFO 09:54:12] my_main Estimated time left: 22 minutes, 59 seconds. Time passed: 7 hours, 24 minutes, 25 seconds
[INFO 09:54:19] my_main Saving models to results/models/qmix_llm_seed60798620_LevelBasedForaging-v3_2024-09-21 02:29:44.216202/955740
[INFO 10:17:49] my_main Finished Training
Process Process-10:
Traceback (most recent call last):
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/wangyida/Repos/epymarl/src/runners/parallel_runner.py", line 371, in env_worker
    teacher.close()
  File "/home/wangyida/Repos/epymarl/src/teachers/teacher.py", line 37, in close
    self.planner.close()
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 71, in close
    self.cache.sync()
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 103, in sync
    storage.update(self.cache)
  File "<string>", line 2, in __getitem__
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/managers.py", line 821, in _callmethod
    conn.send((self._id, methodname, args, kwds))
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 206, in send
    self._send_bytes(_ForkingPickler.dumps(obj))
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 427, in _send_bytes
    self._send(header + buf)
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 384, in _send
    n = write(self._handle, buf)
        ^^^^^^^^^^^^^^^^^^^^^^^^
BrokenPipeError: [Errno 32] Broken pipe
Process Process-9:
Process Process-7:
Process Process-3:
Process Process-5:
Process Process-4:
Process Process-6:
Process Process-8:
Process Process-11:
Process Process-2:
Exiting Main
Stopping all threads
Thread Thread-1 is alive! Is daemon: False
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/wangyida/Repos/epymarl/src/runners/parallel_runner.py", line 371, in env_worker
    teacher.close()
  File "/home/wangyida/Repos/epymarl/src/teachers/teacher.py", line 37, in close
    self.planner.close()
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 71, in close
    self.cache.sync()
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 103, in sync
    storage.update(self.cache)
  File "<string>", line 2, in keys
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
    kind, result = conn.recv()
                   ^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
          ^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
    buf = self._recv(4)
          ^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
    chunk = read(handle, remaining)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/wangyida/Repos/epymarl/src/runners/parallel_runner.py", line 371, in env_worker
    teacher.close()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/wangyida/Repos/epymarl/src/runners/parallel_runner.py", line 371, in env_worker
    teacher.close()
  File "/home/wangyida/Repos/epymarl/src/teachers/teacher.py", line 37, in close
    self.planner.close()
ConnectionResetError: [Errno 104] Connection reset by peer
  File "/home/wangyida/Repos/epymarl/src/runners/parallel_runner.py", line 371, in env_worker
    teacher.close()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/wangyida/Repos/epymarl/src/teachers/teacher.py", line 37, in close
    self.planner.close()
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 71, in close
    self.cache.sync()
  File "/home/wangyida/Repos/epymarl/src/teachers/teacher.py", line 37, in close
    self.planner.close()
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 71, in close
    self.cache.sync()
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 71, in close
    self.cache.sync()
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 103, in sync
    storage.update(self.cache)
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 103, in sync
    storage.update(self.cache)
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 103, in sync
    storage.update(self.cache)
  File "/home/wangyida/Repos/epymarl/src/runners/parallel_runner.py", line 371, in env_worker
    teacher.close()
  File "/home/wangyida/Repos/epymarl/src/runners/parallel_runner.py", line 371, in env_worker
    teacher.close()
  File "<string>", line 2, in keys
  File "<string>", line 2, in keys
  File "/home/wangyida/Repos/epymarl/src/teachers/teacher.py", line 37, in close
    self.planner.close()
  File "/home/wangyida/Repos/epymarl/src/teachers/teacher.py", line 37, in close
    self.planner.close()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
    kind, result = conn.recv()
                   ^^^^^^^^^^^
  File "<string>", line 2, in keys
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
    kind, result = conn.recv()
                   ^^^^^^^^^^^
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 71, in close
    self.cache.sync()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
          ^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 71, in close
    self.cache.sync()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
    kind, result = conn.recv()
                   ^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
          ^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
    buf = self._recv(4)
          ^^^^^^^^^^^^^
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 103, in sync
    storage.update(self.cache)
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 103, in sync
    storage.update(self.cache)
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
    chunk = read(handle, remaining)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
          ^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
    buf = self._recv(4)
          ^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
    buf = self._recv(4)
          ^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
    chunk = read(handle, remaining)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in keys
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
    chunk = read(handle, remaining)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in keys
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
    kind, result = conn.recv()
                   ^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
    kind, result = conn.recv()
                   ^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
          ^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
          ^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
    buf = self._recv(4)
          ^^^^^^^^^^^^^
ConnectionResetError: [Errno 104] Connection reset by peer
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
    buf = self._recv(4)
          ^^^^^^^^^^^^^
  File "/home/wangyida/Repos/epymarl/src/runners/parallel_runner.py", line 371, in env_worker
    teacher.close()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
    chunk = read(handle, remaining)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
    chunk = read(handle, remaining)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/Repos/epymarl/src/teachers/teacher.py", line 37, in close
    self.planner.close()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 71, in close
    self.cache.sync()
ConnectionResetError: [Errno 104] Connection reset by peer
ConnectionResetError: [Errno 104] Connection reset by peer
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 103, in sync
    storage.update(self.cache)
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/wangyida/Repos/epymarl/src/runners/parallel_runner.py", line 371, in env_worker
    teacher.close()
  File "<string>", line 2, in keys
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
ConnectionResetError: [Errno 104] Connection reset by peer
  File "/home/wangyida/Repos/epymarl/src/teachers/teacher.py", line 37, in close
    self.planner.close()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
    kind, result = conn.recv()
                   ^^^^^^^^^^^
ConnectionResetError: [Errno 104] Connection reset by peer
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
          ^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 71, in close
    self.cache.sync()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
    buf = self._recv(4)
          ^^^^^^^^^^^^^
  File "/home/wangyida/Repos/epymarl/src/runners/parallel_runner.py", line 371, in env_worker
    teacher.close()
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 103, in sync
    storage.update(self.cache)
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
    chunk = read(handle, remaining)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/Repos/epymarl/src/teachers/teacher.py", line 37, in close
    self.planner.close()
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 71, in close
    self.cache.sync()
  File "<string>", line 2, in keys
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 103, in sync
    storage.update(self.cache)
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
    kind, result = conn.recv()
                   ^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
          ^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in keys
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
    buf = self._recv(4)
          ^^^^^^^^^^^^^
ConnectionResetError: [Errno 104] Connection reset by peer
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
    kind, result = conn.recv()
                   ^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
    chunk = read(handle, remaining)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
          ^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
    buf = self._recv(4)
          ^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
    chunk = read(handle, remaining)
            ^^^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [Errno 104] Connection reset by peer
ConnectionResetError: [Errno 104] Connection reset by peer
Thread joined
Exiting script
[DEBUG 10:17:50] my_main Finished after 7:48:07.
[INFO 10:17:50] pymarl Completed after 7:48:07
