[INFO 22:14:16] pymarl Running command 'my_main'
[INFO 22:14:16] pymarl Started run with ID "1"
[DEBUG 22:14:16] pymarl Starting Heartbeat
[DEBUG 22:14:16] my_main Started
[INFO 22:14:16] my_main Experiment Parameters:
[INFO 22:14:16] my_main 

{   'action_selector': 'epsilon_greedy',
    'add_value_last_step': True,
    'agent': 'rnn',
    'agent_output_type': 'q',
    'batch_size': 10,
    'batch_size_run': 10,
    'buffer_cpu_only': True,
    'buffer_size': 10,
    'checkpoint_path': '',
    'common_reward': True,
    'double_q': True,
    'env': 'posggym',
    'env_args': {   'key': 'LevelBasedForaging-v3',
                    'max_food': 4,
                    'observation_mode': 'tuple',
                    'pretrained_wrapper': None,
                    'seed': 515710196,
                    'size': 10,
                    'time_limit': 100},
    'epsilon_anneal_time': 50000,
    'epsilon_finish': 0.05,
    'epsilon_start': 1.0,
    'evaluate': False,
    'evaluation_epsilon': 0.0,
    'gamma': 0.99,
    'grad_norm_clip': 10,
    'hidden_dim': 64,
    'hypergroup': None,
    'label': 'default_label',
    'learner': 'q_learner',
    'learner_log_interval': 10000,
    'llm': None,
    'llm_args': {   },
    'llm_cache_path': None,
    'load_step': 0,
    'local_results_path': 'results',
    'log_interval': 50000,
    'lr': 0.0005,
    'mac': 'basic_mac',
    'mixer': 'vdn',
    'name': 'vdn',
    'obs_agent_id': True,
    'obs_individual_obs': False,
    'obs_last_action': False,
    'optim_alpha': 0.99,
    'optim_eps': 1e-05,
    'render': False,
    'repeat_id': 1,
    'reward_scalarisation': 'sum',
    'runner': 'parallel',
    'runner_log_interval': 10000,
    'save_model': True,
    'save_model_interval': 50000,
    'save_replay': False,
    'seed': 515710196,
    'standardise_returns': False,
    'standardise_rewards': True,
    't_max': 1000000,
    'target_update_interval_or_tau': 200,
    'test_greedy': True,
    'test_interval': 50000,
    'test_nepisode': 100,
    'use_cuda': True,
    'use_rnn': False,
    'use_tensorboard': True,
    'use_wandb': False,
    'wandb_mode': 'offline',
    'wandb_project': None,
    'wandb_save_model': False,
    'wandb_team': None}

[INFO 22:14:16] my_main *******************
[INFO 22:14:16] my_main Tensorboard logging dir:
[INFO 22:14:16] my_main /home/wangyida/Repos/epymarl/results/tb_logs/vdn_seed515710196_LevelBasedForaging-v3_2024-09-20 22:14:16.057754
[INFO 22:14:16] my_main *******************
[INFO 22:14:18] my_main Beginning training for 1000000 timesteps
[INFO 22:14:20] my_main t_env: 500 / 1000000
[INFO 22:14:20] my_main Estimated time left: 40 seconds. Time passed: 2 seconds
[INFO 22:14:23] my_main Saving models to results/models/vdn_seed515710196_LevelBasedForaging-v3_2024-09-20 22:14:16.057754/500
[INFO 22:15:01] my_main Recent Stats | t_env:      50482 | Episode:     1010
ep_length_mean:           49.9829	epsilon:                   0.2308	grad_norm:                 0.5652	q_taken_mean:              0.0428
return_mean:               0.1218	return_std:                0.1519	target_mean:               0.0482	td_error_abs:              0.3196
td_loss:                   1.0991	test_ep_length_mean:      50.0000	test_return_mean:          0.0000	test_return_std:           0.0000

[INFO 22:15:01] my_main t_env: 50982 / 1000000
[INFO 22:15:01] my_main Estimated time left: 12 minutes, 47 seconds. Time passed: 42 seconds
[INFO 22:15:05] my_main Saving models to results/models/vdn_seed515710196_LevelBasedForaging-v3_2024-09-20 22:14:16.057754/50982
[INFO 22:15:44] my_main Recent Stats | t_env:     100482 | Episode:     2010
ep_length_mean:           50.0000	epsilon:                   0.0500	grad_norm:                 0.2396	q_taken_mean:              0.0852
return_mean:               0.0994	return_std:                0.1495	target_mean:               0.0993	td_error_abs:              0.1690
td_loss:                   0.6440	test_ep_length_mean:      50.0000	test_return_mean:          0.0198	test_return_std:           0.0420

[INFO 22:15:45] my_main t_env: 100982 / 1000000
[INFO 22:15:45] my_main Estimated time left: 13 minutes, 0 seconds. Time passed: 1 minutes, 26 seconds
[INFO 22:15:48] my_main Saving models to results/models/vdn_seed515710196_LevelBasedForaging-v3_2024-09-20 22:14:16.057754/100982
[INFO 22:16:28] my_main Recent Stats | t_env:     150482 | Episode:     3010
ep_length_mean:           50.0000	epsilon:                   0.0500	grad_norm:                 0.3096	q_taken_mean:              0.0837
return_mean:               0.0800	return_std:                0.1329	target_mean:               0.0978	td_error_abs:              0.1764
td_loss:                   1.0074	test_ep_length_mean:      50.0000	test_return_mean:          0.0266	test_return_std:           0.0606

[INFO 22:16:28] my_main t_env: 150982 / 1000000
[INFO 22:16:28] my_main Estimated time left: 12 minutes, 14 seconds. Time passed: 2 minutes, 9 seconds
[INFO 22:16:31] my_main Saving models to results/models/vdn_seed515710196_LevelBasedForaging-v3_2024-09-20 22:14:16.057754/150982
[INFO 22:17:12] my_main Recent Stats | t_env:     200482 | Episode:     4010
ep_length_mean:           50.0000	epsilon:                   0.0500	grad_norm:                 0.5124	q_taken_mean:              0.0872
return_mean:               0.0933	return_std:                0.1379	target_mean:               0.0919	td_error_abs:              0.1888
td_loss:                   1.0251	test_ep_length_mean:      50.0000	test_return_mean:          0.0368	test_return_std:           0.0753

[INFO 22:17:12] my_main t_env: 200982 / 1000000
[INFO 22:17:12] my_main Estimated time left: 11 minutes, 45 seconds. Time passed: 2 minutes, 53 seconds
[INFO 22:17:16] my_main Saving models to results/models/vdn_seed515710196_LevelBasedForaging-v3_2024-09-20 22:14:16.057754/200982
[INFO 22:17:56] my_main Recent Stats | t_env:     250482 | Episode:     5010
ep_length_mean:           50.0000	epsilon:                   0.0500	grad_norm:                 1.0932	q_taken_mean:              0.0983
return_mean:               0.0920	return_std:                0.1365	target_mean:               0.0769	td_error_abs:              0.1742
td_loss:                   0.5039	test_ep_length_mean:      50.0000	test_return_mean:          0.0386	test_return_std:           0.0787

[INFO 22:17:56] my_main t_env: 250982 / 1000000
[INFO 22:17:56] my_main Estimated time left: 11 minutes, 0 seconds. Time passed: 3 minutes, 37 seconds
[INFO 22:18:00] my_main Saving models to results/models/vdn_seed515710196_LevelBasedForaging-v3_2024-09-20 22:14:16.057754/250982
[INFO 22:18:40] my_main Recent Stats | t_env:     300925 | Episode:     6020
ep_length_mean:           49.9457	epsilon:                   0.0500	grad_norm:                 1.9964	q_taken_mean:              0.1010
return_mean:               0.0996	return_std:                0.1494	target_mean:               0.0803	td_error_abs:              0.2057
td_loss:                   0.6791	test_ep_length_mean:      50.0000	test_return_mean:          0.0466	test_return_std:           0.0979

[INFO 22:18:40] my_main t_env: 301425 / 1000000
[INFO 22:18:40] my_main Estimated time left: 10 minutes, 7 seconds. Time passed: 4 minutes, 21 seconds
[INFO 22:18:44] my_main Saving models to results/models/vdn_seed515710196_LevelBasedForaging-v3_2024-09-20 22:14:16.057754/301425
[INFO 22:19:23] my_main Recent Stats | t_env:     351420 | Episode:     7030
ep_length_mean:           49.9952	epsilon:                   0.0500	grad_norm:                 1.6807	q_taken_mean:              0.1525
return_mean:               0.0991	return_std:                0.1469	target_mean:               0.1448	td_error_abs:              0.2216
td_loss:                   0.7209	test_ep_length_mean:      50.0000	test_return_mean:          0.0471	test_return_std:           0.1018

[INFO 22:19:24] my_main t_env: 351920 / 1000000
[INFO 22:19:24] my_main Estimated time left: 9 minutes, 18 seconds. Time passed: 5 minutes, 5 seconds
[INFO 22:19:27] my_main Saving models to results/models/vdn_seed515710196_LevelBasedForaging-v3_2024-09-20 22:14:16.057754/351920
[INFO 22:20:10] my_main Recent Stats | t_env:     401420 | Episode:     8030
ep_length_mean:           50.0000	epsilon:                   0.0500	grad_norm:                 2.1972	q_taken_mean:              0.0651
return_mean:               0.0945	return_std:                0.1384	target_mean:               0.0688	td_error_abs:              0.1970
td_loss:                   0.6400	test_ep_length_mean:      50.0000	test_return_mean:          0.0500	test_return_std:           0.1020

[INFO 22:20:10] my_main t_env: 401920 / 1000000
[INFO 22:20:10] my_main Estimated time left: 9 minutes, 15 seconds. Time passed: 5 minutes, 51 seconds
[INFO 22:20:14] my_main Saving models to results/models/vdn_seed515710196_LevelBasedForaging-v3_2024-09-20 22:14:16.057754/401920
[INFO 22:20:58] my_main Recent Stats | t_env:     451420 | Episode:     9030
ep_length_mean:           50.0000	epsilon:                   0.0500	grad_norm:                 2.4611	q_taken_mean:              0.1187
return_mean:               0.1004	return_std:                0.1486	target_mean:               0.1265	td_error_abs:              0.2642
td_loss:                   0.8202	test_ep_length_mean:      50.0000	test_return_mean:          0.0524	test_return_std:           0.1042

[INFO 22:20:58] my_main t_env: 451920 / 1000000
[INFO 22:20:58] my_main Estimated time left: 8 minutes, 46 seconds. Time passed: 6 minutes, 39 seconds
[INFO 22:21:02] my_main Saving models to results/models/vdn_seed515710196_LevelBasedForaging-v3_2024-09-20 22:14:16.057754/451920
[INFO 22:21:45] my_main Recent Stats | t_env:     501892 | Episode:    10040
ep_length_mean:           49.9733	epsilon:                   0.0500	grad_norm:                 4.0971	q_taken_mean:              0.1579
return_mean:               0.1141	return_std:                0.1583	target_mean:               0.1589	td_error_abs:              0.2571
td_loss:                   0.5707	test_ep_length_mean:      50.0000	test_return_mean:          0.0586	test_return_std:           0.1085

[INFO 22:21:46] my_main t_env: 502392 / 1000000
[INFO 22:21:46] my_main Estimated time left: 7 minutes, 50 seconds. Time passed: 7 minutes, 27 seconds
[INFO 22:21:50] my_main Saving models to results/models/vdn_seed515710196_LevelBasedForaging-v3_2024-09-20 22:14:16.057754/502392
[INFO 22:22:33] my_main Recent Stats | t_env:     552355 | Episode:    11050
ep_length_mean:           49.9648	epsilon:                   0.0500	grad_norm:                 2.9640	q_taken_mean:              0.0380
return_mean:               0.1067	return_std:                0.1524	target_mean:               0.0458	td_error_abs:              0.2478
td_loss:                   0.7452	test_ep_length_mean:      50.0000	test_return_mean:          0.0618	test_return_std:           0.1101

[INFO 22:22:33] my_main t_env: 552855 / 1000000
[INFO 22:22:33] my_main Estimated time left: 7 minutes, 2 seconds. Time passed: 8 minutes, 15 seconds
[INFO 22:22:37] my_main Saving models to results/models/vdn_seed515710196_LevelBasedForaging-v3_2024-09-20 22:14:16.057754/552855
[INFO 22:23:21] my_main Recent Stats | t_env:     602835 | Episode:    12060
ep_length_mean:           49.9810	epsilon:                   0.0500	grad_norm:                 3.9241	q_taken_mean:              0.0322
return_mean:               0.1323	return_std:                0.1734	target_mean:               0.0752	td_error_abs:              0.2578
td_loss:                   0.8911	test_ep_length_mean:      50.0000	test_return_mean:          0.0720	test_return_std:           0.1211

[INFO 22:23:22] my_main t_env: 603335 / 1000000
[INFO 22:23:22] my_main Estimated time left: 6 minutes, 17 seconds. Time passed: 9 minutes, 3 seconds
[INFO 22:23:25] my_main Saving models to results/models/vdn_seed515710196_LevelBasedForaging-v3_2024-09-20 22:14:16.057754/603335
[INFO 22:24:08] my_main Recent Stats | t_env:     652835 | Episode:    13060
ep_length_mean:           50.0000	epsilon:                   0.0500	grad_norm:                 3.2114	q_taken_mean:              0.0810
return_mean:               0.1212	return_std:                0.1583	target_mean:               0.0886	td_error_abs:              0.2680
td_loss:                   0.8171	test_ep_length_mean:      50.0000	test_return_mean:          0.0830	test_return_std:           0.1325

[INFO 22:24:09] my_main t_env: 653335 / 1000000
[INFO 22:24:09] my_main Estimated time left: 5 minutes, 27 seconds. Time passed: 9 minutes, 50 seconds
[INFO 22:24:13] my_main Saving models to results/models/vdn_seed515710196_LevelBasedForaging-v3_2024-09-20 22:14:16.057754/653335
[INFO 22:24:56] my_main Recent Stats | t_env:     703332 | Episode:    14070
ep_length_mean:           49.9971	epsilon:                   0.0500	grad_norm:                 3.9761	q_taken_mean:              0.0724
return_mean:               0.1286	return_std:                0.1675	target_mean:               0.0727	td_error_abs:              0.3078
td_loss:                   0.7117	test_ep_length_mean:      50.0000	test_return_mean:          0.0857	test_return_std:           0.1357

[INFO 22:24:57] my_main t_env: 703832 / 1000000
[INFO 22:24:57] my_main Estimated time left: 4 minutes, 40 seconds. Time passed: 10 minutes, 38 seconds
[INFO 22:25:00] my_main Saving models to results/models/vdn_seed515710196_LevelBasedForaging-v3_2024-09-20 22:14:16.057754/703832
[INFO 22:25:44] my_main Recent Stats | t_env:     753728 | Episode:    15080
ep_length_mean:           49.9390	epsilon:                   0.0500	grad_norm:                 3.8681	q_taken_mean:              0.0802
return_mean:               0.1355	return_std:                0.1715	target_mean:               0.0947	td_error_abs:              0.3154
td_loss:                   1.0217	test_ep_length_mean:      50.0000	test_return_mean:          0.0971	test_return_std:           0.1496

[INFO 22:25:44] my_main t_env: 754228 / 1000000
[INFO 22:25:44] my_main Estimated time left: 3 minutes, 51 seconds. Time passed: 11 minutes, 25 seconds
[INFO 22:25:48] my_main Saving models to results/models/vdn_seed515710196_LevelBasedForaging-v3_2024-09-20 22:14:16.057754/754228
[INFO 22:26:32] my_main Recent Stats | t_env:     804190 | Episode:    16090
ep_length_mean:           49.9257	epsilon:                   0.0500	grad_norm:                 2.2943	q_taken_mean:              0.0478
return_mean:               0.1375	return_std:                0.1723	target_mean:               0.0478	td_error_abs:              0.2849
td_loss:                   0.6652	test_ep_length_mean:      50.0000	test_return_mean:          0.1190	test_return_std:           0.1652

[INFO 22:26:32] my_main t_env: 804690 / 1000000
[INFO 22:26:32] my_main Estimated time left: 3 minutes, 5 seconds. Time passed: 12 minutes, 13 seconds
[INFO 22:26:36] my_main Saving models to results/models/vdn_seed515710196_LevelBasedForaging-v3_2024-09-20 22:14:16.057754/804690
[INFO 22:27:20] my_main Recent Stats | t_env:     854472 | Episode:    17100
ep_length_mean:           49.8571	epsilon:                   0.0500	grad_norm:                 3.6302	q_taken_mean:              0.0365
return_mean:               0.1518	return_std:                0.1768	target_mean:               0.0539	td_error_abs:              0.3061
td_loss:                   0.8632	test_ep_length_mean:      50.0000	test_return_mean:          0.1198	test_return_std:           0.1654

[INFO 22:27:20] my_main t_env: 854972 / 1000000
[INFO 22:27:20] my_main Estimated time left: 2 minutes, 19 seconds. Time passed: 13 minutes, 1 seconds
[INFO 22:27:24] my_main Saving models to results/models/vdn_seed515710196_LevelBasedForaging-v3_2024-09-20 22:14:16.057754/854972
[INFO 22:28:08] my_main Recent Stats | t_env:     904681 | Episode:    18110
ep_length_mean:           49.6581	epsilon:                   0.0500	grad_norm:                 2.5811	q_taken_mean:             -0.0567
return_mean:               0.1707	return_std:                0.2068	target_mean:              -0.0434	td_error_abs:              0.2395
td_loss:                   0.4938	test_ep_length_mean:      50.0000	test_return_mean:          0.1357	test_return_std:           0.1779

[INFO 22:28:09] my_main t_env: 905145 / 1000000
[INFO 22:28:09] my_main Estimated time left: 1 minutes, 31 seconds. Time passed: 13 minutes, 50 seconds
[INFO 22:28:12] my_main Saving models to results/models/vdn_seed515710196_LevelBasedForaging-v3_2024-09-20 22:14:16.057754/905145
[INFO 22:28:56] my_main Recent Stats | t_env:     954894 | Episode:    19120
ep_length_mean:           49.7267	epsilon:                   0.0500	grad_norm:                 3.2057	q_taken_mean:             -0.0070
return_mean:               0.1918	return_std:                0.2209	target_mean:               0.0261	td_error_abs:              0.2854
td_loss:                   0.6615	test_ep_length_mean:      49.8460	test_return_mean:          0.1578	test_return_std:           0.1944

[INFO 22:28:57] my_main t_env: 955394 / 1000000
[INFO 22:28:57] my_main Estimated time left: 42 seconds. Time passed: 14 minutes, 38 seconds
[INFO 22:29:01] my_main Saving models to results/models/vdn_seed515710196_LevelBasedForaging-v3_2024-09-20 22:14:16.057754/955394
[INFO 22:29:37] my_main Finished Training
Exiting Main
Stopping all threads
Thread Thread-1 is alive! Is daemon: False
Thread joined
Exiting script
[DEBUG 22:29:38] my_main Finished after 0:15:22.
[INFO 22:29:38] pymarl Completed after 0:15:22
