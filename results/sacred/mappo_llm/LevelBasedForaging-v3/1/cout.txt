[INFO 18:24:17] pymarl Running command 'my_main'
[INFO 18:24:17] pymarl Started run with ID "1"
[DEBUG 18:24:17] pymarl Starting Heartbeat
[DEBUG 18:24:17] my_main Started
[INFO 18:24:17] my_main Experiment Parameters:
[INFO 18:24:17] my_main 

{   'action_selector': 'soft_policies',
    'add_value_last_step': True,
    'agent': 'rnn',
    'agent_output_type': 'pi_logits',
    'batch_size': 10,
    'batch_size_run': 10,
    'buffer_cpu_only': True,
    'buffer_size': 10,
    'checkpoint_path': '',
    'common_reward': True,
    'critic_type': 'cv_critic',
    'entropy_coef': 0.001,
    'env': 'posggym',
    'env_args': {   'key': 'LevelBasedForaging-v3',
                    'max_food': 4,
                    'observation_mode': 'tuple',
                    'pretrained_wrapper': None,
                    'seed': 251788030,
                    'size': 10,
                    'time_limit': 100},
    'epochs': 4,
    'eps_clip': 0.2,
    'evaluate': False,
    'gamma': 0.99,
    'grad_norm_clip': 10,
    'hidden_dim': 128,
    'hypergroup': None,
    'ks_coef_end': 0.1,
    'ks_coef_start': 10.0,
    'ks_duration': 1000000,
    'label': 'default_label',
    'learner': 'ppo_learner',
    'learner_log_interval': 10000,
    'llm': 'glm',
    'llm_args': {   'key': '885a088fad70c90d664fa7541d6392b3.Mdm3tIwpzF3KHGWF',
                    'model': 'GLM-4-Air',
                    'temperature': 0.7,
                    'top_p': 0.7},
    'llm_cache_path': 'lbf_cache',
    'llm_nretry': 10,
    'llm_nsample': 5,
    'load_step': 0,
    'local_results_path': 'results',
    'log_interval': 50000,
    'lr': 0.0003,
    'mac': 'basic_mac',
    'mask_before_softmax': True,
    'name': 'mappo_llm',
    'obs_agent_id': True,
    'obs_individual_obs': False,
    'obs_last_action': False,
    'optim_alpha': 0.99,
    'optim_eps': 1e-05,
    'q_nstep': 5,
    'render': False,
    'repeat_id': 1,
    'reward_scalarisation': 'sum',
    'runner': 'parallel',
    'runner_log_interval': 10000,
    'save_model': True,
    'save_model_interval': 50000,
    'save_replay': False,
    'seed': 251788030,
    'standardise_returns': False,
    'standardise_rewards': True,
    't_max': 1000000,
    'target_update_interval_or_tau': 0.01,
    'test_greedy': True,
    'test_interval': 50000,
    'test_nepisode': 100,
    'use_cuda': True,
    'use_rnn': True,
    'use_tensorboard': True,
    'use_wandb': False,
    'wandb_mode': 'offline',
    'wandb_project': None,
    'wandb_save_model': False,
    'wandb_team': None}

[INFO 18:24:17] my_main *******************
[INFO 18:24:17] my_main Tensorboard logging dir:
[INFO 18:24:17] my_main /home/wangyida/Repos/epymarl/results/tb_logs/mappo_llm_seed251788030_LevelBasedForaging-v3_2024-09-20 18:24:17.123473
[INFO 18:24:17] my_main *******************
[INFO 18:24:19] my_main Beginning training for 1000000 timesteps
[INFO 18:33:06] my_main t_env: 500 / 1000000
[INFO 18:33:06] my_main Estimated time left: 2 hours, 53 minutes, 41 seconds. Time passed: 8 minutes, 46 seconds
[INFO 18:33:09] my_main Saving models to results/models/mappo_llm_seed251788030_LevelBasedForaging-v3_2024-09-20 18:24:17.123473/500
[INFO 20:43:32] my_main Recent Stats | t_env:      50281 | Episode:     1010
advantage_mean:            0.0854	agent_grad_norm:           0.4733	critic_grad_norm:          2.1654	critic_loss:               5.5169
ep_length_mean:           49.9124	kickstart_coef:            9.7943	kickstart_loss:           -0.1826	pg_loss:                  -0.0950
pi_max:                    0.6371	q_taken_mean:              0.0309	return_mean:               0.1568	return_std:                0.1768
target_mean:               0.1163	td_error_abs:              1.0809	test_ep_length_mean:      50.0000	test_return_mean:          0.1212
test_return_std:           0.1291	
[INFO 20:43:34] my_main t_env: 50781 / 1000000
[INFO 20:43:34] my_main Estimated time left: 1 days, 17 hours, 2 minutes, 51 seconds. Time passed: 2 hours, 19 minutes, 14 seconds
[INFO 20:43:37] my_main Saving models to results/models/mappo_llm_seed251788030_LevelBasedForaging-v3_2024-09-20 18:24:17.123473/50781
[INFO 21:30:29] my_main Recent Stats | t_env:     100381 | Episode:     2020
advantage_mean:           -0.1510	agent_grad_norm:           0.7377	critic_grad_norm:          7.6246	critic_loss:               3.0827
ep_length_mean:           49.5667	kickstart_coef:            9.2838	kickstart_loss:           -0.2270	pg_loss:                   0.1462
pi_max:                    0.9675	q_taken_mean:             -0.1106	return_mean:               0.2134	return_std:                0.2268
target_mean:              -0.2616	td_error_abs:              0.8189	test_ep_length_mean:      49.8250	test_return_mean:          0.1672
test_return_std:           0.1854	
[INFO 21:31:34] my_main t_env: 100881 / 1000000
[INFO 21:31:34] my_main Estimated time left: 14 hours, 21 minutes, 25 seconds. Time passed: 3 hours, 7 minutes, 14 seconds
[INFO 21:31:37] my_main Saving models to results/models/mappo_llm_seed251788030_LevelBasedForaging-v3_2024-09-20 18:24:17.123473/100881
[INFO 22:12:05] my_main Recent Stats | t_env:     150783 | Episode:     3050
advantage_mean:            0.2037	agent_grad_norm:           0.3999	critic_grad_norm:          5.6388	critic_loss:               4.4403
ep_length_mean:           49.0971	kickstart_coef:            8.7726	kickstart_loss:           -0.2462	pg_loss:                  -0.2117
pi_max:                    0.9709	q_taken_mean:             -0.2953	return_mean:               0.2681	return_std:                0.2619
target_mean:              -0.0916	td_error_abs:              0.8031	test_ep_length_mean:      49.4300	test_return_mean:          0.1968
test_return_std:           0.2168	
[INFO 22:12:07] my_main t_env: 151277 / 1000000
[INFO 22:12:07] my_main Estimated time left: 11 hours, 22 minutes, 58 seconds. Time passed: 3 hours, 47 minutes, 47 seconds
[INFO 22:12:10] my_main Saving models to results/models/mappo_llm_seed251788030_LevelBasedForaging-v3_2024-09-20 18:24:17.123473/151277
[INFO 22:45:54] my_main Recent Stats | t_env:     200864 | Episode:     4090
advantage_mean:            0.1146	agent_grad_norm:           0.9623	critic_grad_norm:          8.8350	critic_loss:               4.1627
ep_length_mean:           48.2819	kickstart_coef:            8.2683	kickstart_loss:           -0.2369	pg_loss:                  -0.1187
pi_max:                    0.8162	q_taken_mean:             -0.4511	return_mean:               0.3147	return_std:                0.2892
target_mean:              -0.3365	td_error_abs:              0.9041	test_ep_length_mean:      49.2475	test_return_mean:          0.2353
test_return_std:           0.2371	
[INFO 22:45:57] my_main t_env: 201364 / 1000000
[INFO 22:45:57] my_main Estimated time left: 8 hours, 59 minutes, 33 seconds. Time passed: 4 hours, 21 minutes, 37 seconds
[INFO 22:46:01] my_main Saving models to results/models/mappo_llm_seed251788030_LevelBasedForaging-v3_2024-09-20 18:24:17.123473/201364
[INFO 23:13:42] my_main Recent Stats | t_env:     251072 | Episode:     5130
advantage_mean:           -0.0294	agent_grad_norm:           0.5513	critic_grad_norm:         12.1292	critic_loss:               5.6111
ep_length_mean:           48.2352	kickstart_coef:            7.7672	kickstart_loss:           -0.2410	pg_loss:                   0.0222
pi_max:                    0.9294	q_taken_mean:              0.2463	return_mean:               0.3081	return_std:                0.2989
target_mean:               0.2169	td_error_abs:              1.2543	test_ep_length_mean:      49.2260	test_return_mean:          0.2487
test_return_std:           0.2441	
[INFO 23:13:45] my_main t_env: 251502 / 1000000
[INFO 23:13:45] my_main Estimated time left: 6 hours, 55 minutes, 3 seconds. Time passed: 4 hours, 49 minutes, 25 seconds
[INFO 23:13:49] my_main Saving models to results/models/mappo_llm_seed251788030_LevelBasedForaging-v3_2024-09-20 18:24:17.123473/251502
[INFO 23:48:52] my_main t_env: 301511 / 1000000
[INFO 23:48:52] my_main Estimated time left: 8 hours, 10 minutes, 27 seconds. Time passed: 5 hours, 24 minutes, 32 seconds
[INFO 23:48:57] my_main Saving models to results/models/mappo_llm_seed251788030_LevelBasedForaging-v3_2024-09-20 18:24:17.123473/301511
[INFO 23:48:57] my_main Recent Stats | t_env:     301511 | Episode:     6180
advantage_mean:            0.1198	agent_grad_norm:           0.5839	critic_grad_norm:          7.2784	critic_loss:               4.6902
ep_length_mean:           48.0519	kickstart_coef:            7.2629	kickstart_loss:           -0.2393	pg_loss:                  -0.1282
pi_max:                    0.9164	q_taken_mean:             -0.7233	return_mean:               0.3209	return_std:                0.2987
target_mean:              -0.6035	td_error_abs:              0.9923	test_ep_length_mean:      48.8380	test_return_mean:          0.3020
test_return_std:           0.2855	
[INFO 00:26:58] my_main t_env: 351549 / 1000000
[INFO 00:26:58] my_main Estimated time left: 8 hours, 13 minutes, 48 seconds. Time passed: 6 hours, 2 minutes, 38 seconds
[INFO 00:27:03] my_main Saving models to results/models/mappo_llm_seed251788030_LevelBasedForaging-v3_2024-09-20 18:24:17.123473/351549
[INFO 00:27:03] my_main Recent Stats | t_env:     351549 | Episode:     7240
advantage_mean:           -0.2330	agent_grad_norm:           0.4713	critic_grad_norm:         12.4256	critic_loss:               4.8580
ep_length_mean:           47.2430	kickstart_coef:            6.7573	kickstart_loss:           -0.2310	pg_loss:                   0.2267
pi_max:                    0.8835	q_taken_mean:             -0.4517	return_mean:               0.3512	return_std:                0.3226
target_mean:              -0.6847	td_error_abs:              1.2470	test_ep_length_mean:      48.4460	test_return_mean:          0.3189
test_return_std:           0.2969	
[INFO 00:53:01] my_main t_env: 401798 / 1000000
[INFO 00:53:01] my_main Estimated time left: 5 hours, 10 minutes, 4 seconds. Time passed: 6 hours, 28 minutes, 41 seconds
[INFO 00:53:06] my_main Saving models to results/models/mappo_llm_seed251788030_LevelBasedForaging-v3_2024-09-20 18:24:17.123473/401798
[INFO 00:53:06] my_main Recent Stats | t_env:     401798 | Episode:     8330
advantage_mean:           -0.1832	agent_grad_norm:           1.0234	critic_grad_norm:         15.0729	critic_loss:               5.8769
ep_length_mean:           46.0699	kickstart_coef:            6.2489	kickstart_loss:           -0.2491	pg_loss:                   0.1751
pi_max:                    0.8493	q_taken_mean:              0.2549	return_mean:               0.4030	return_std:                0.3480
target_mean:               0.0717	td_error_abs:              1.5444	test_ep_length_mean:      48.1840	test_return_mean:          0.3236
test_return_std:           0.3032	
[INFO 01:30:05] my_main t_env: 451881 / 1000000
[INFO 01:30:05] my_main Estimated time left: 6 hours, 45 minutes, 38 seconds. Time passed: 7 hours, 5 minutes, 45 seconds
[INFO 01:30:10] my_main Saving models to results/models/mappo_llm_seed251788030_LevelBasedForaging-v3_2024-09-20 18:24:17.123473/451881
[INFO 01:30:10] my_main Recent Stats | t_env:     451881 | Episode:     9430
advantage_mean:           -0.1115	agent_grad_norm:           0.6814	critic_grad_norm:         12.5166	critic_loss:               5.3870
ep_length_mean:           45.5955	kickstart_coef:            5.7428	kickstart_loss:           -0.2514	pg_loss:                   0.1031
pi_max:                    0.8955	q_taken_mean:             -0.6349	return_mean:               0.4337	return_std:                0.3549
target_mean:              -0.7464	td_error_abs:              1.3093	test_ep_length_mean:      47.5680	test_return_mean:          0.3578
test_return_std:           0.3176	
[INFO 02:06:06] my_main t_env: 502044 / 1000000
[INFO 02:06:06] my_main Estimated time left: 5 hours, 57 minutes, 28 seconds. Time passed: 7 hours, 41 minutes, 46 seconds
[INFO 02:06:11] my_main Saving models to results/models/mappo_llm_seed251788030_LevelBasedForaging-v3_2024-09-20 18:24:17.123473/502044
[INFO 02:06:11] my_main Recent Stats | t_env:     502044 | Episode:    10520
advantage_mean:            0.0219	agent_grad_norm:           0.8295	critic_grad_norm:         12.3167	critic_loss:               6.0636
ep_length_mean:           46.0505	kickstart_coef:            5.2371	kickstart_loss:           -0.2494	pg_loss:                  -0.0333
pi_max:                    0.9415	q_taken_mean:             -0.6396	return_mean:               0.4145	return_std:                0.3545
target_mean:              -0.6178	td_error_abs:              1.4050	test_ep_length_mean:      47.0220	test_return_mean:          0.3658
test_return_std:           0.3300	
[INFO 02:27:47] my_main t_env: 552470 / 1000000
[INFO 02:27:47] my_main Estimated time left: 3 hours, 12 minutes, 29 seconds. Time passed: 8 hours, 3 minutes, 27 seconds
[INFO 02:27:52] my_main Saving models to results/models/mappo_llm_seed251788030_LevelBasedForaging-v3_2024-09-20 18:24:17.123473/552470
[INFO 02:27:52] my_main Recent Stats | t_env:     552470 | Episode:    11600
advantage_mean:           -0.2198	agent_grad_norm:           0.4501	critic_grad_norm:          9.8395	critic_loss:               3.7958
ep_length_mean:           46.7341	kickstart_coef:            4.7317	kickstart_loss:           -0.2318	pg_loss:                   0.2118
pi_max:                    0.9195	q_taken_mean:             -1.2547	return_mean:               0.3744	return_std:                0.3330
target_mean:              -1.4744	td_error_abs:              1.0286	test_ep_length_mean:      46.5460	test_return_mean:          0.3893
test_return_std:           0.3374	
[INFO 02:53:10] my_main t_env: 602718 / 1000000
[INFO 02:53:10] my_main Estimated time left: 3 hours, 20 minutes, 42 seconds. Time passed: 8 hours, 28 minutes, 50 seconds
[INFO 02:53:15] my_main Saving models to results/models/mappo_llm_seed251788030_LevelBasedForaging-v3_2024-09-20 18:24:17.123473/602718
[INFO 02:53:15] my_main Recent Stats | t_env:     602718 | Episode:    12690
advantage_mean:            0.1431	agent_grad_norm:           0.6456	critic_grad_norm:          9.5823	critic_loss:               5.4800
ep_length_mean:           46.1300	kickstart_coef:            4.3298	kickstart_loss:           -0.2279	pg_loss:                  -0.1508
pi_max:                    0.8827	q_taken_mean:             -1.0581	return_mean:               0.3919	return_std:                0.3503
target_mean:              -0.9150	td_error_abs:              1.2599	test_ep_length_mean:      46.4760	test_return_mean:          0.3986
test_return_std:           0.3381	
[INFO 03:20:18] my_main t_env: 653123 / 1000000
[INFO 03:20:18] my_main Estimated time left: 3 hours, 6 minutes, 39 seconds. Time passed: 8 hours, 55 minutes, 58 seconds
[INFO 03:20:23] my_main Saving models to results/models/mappo_llm_seed251788030_LevelBasedForaging-v3_2024-09-20 18:24:17.123473/653123
[INFO 03:20:23] my_main Recent Stats | t_env:     653123 | Episode:    13780
advantage_mean:           -0.1203	agent_grad_norm:           1.0451	critic_grad_norm:         14.4550	critic_loss:               6.5718
ep_length_mean:           46.2845	kickstart_coef:            3.8269	kickstart_loss:           -0.2273	pg_loss:                   0.1107
pi_max:                    0.8474	q_taken_mean:             -0.2812	return_mean:               0.4049	return_std:                0.3578
target_mean:              -0.4015	td_error_abs:              1.6162	test_ep_length_mean:      46.1180	test_return_mean:          0.4107
test_return_std:           0.3485	
[INFO 03:47:12] my_main t_env: 703368 / 1000000
[INFO 03:47:12] my_main Estimated time left: 2 hours, 38 minutes, 50 seconds. Time passed: 9 hours, 22 minutes, 52 seconds
[INFO 03:47:17] my_main Saving models to results/models/mappo_llm_seed251788030_LevelBasedForaging-v3_2024-09-20 18:24:17.123473/703368
[INFO 03:47:17] my_main Recent Stats | t_env:     703368 | Episode:    14860
advantage_mean:           -0.0750	agent_grad_norm:           0.7691	critic_grad_norm:         13.4926	critic_loss:               5.4454
ep_length_mean:           46.6965	kickstart_coef:            3.3232	kickstart_loss:           -0.2531	pg_loss:                   0.0690
pi_max:                    0.8988	q_taken_mean:             -1.0037	return_mean:               0.3859	return_std:                0.3431
target_mean:              -1.0787	td_error_abs:              1.3270	test_ep_length_mean:      45.9640	test_return_mean:          0.4088
test_return_std:           0.3524	
[INFO 04:13:17] my_main t_env: 753599 / 1000000
[INFO 04:13:17] my_main Estimated time left: 2 hours, 7 minutes, 58 seconds. Time passed: 9 hours, 48 minutes, 57 seconds
[INFO 04:13:23] my_main Saving models to results/models/mappo_llm_seed251788030_LevelBasedForaging-v3_2024-09-20 18:24:17.123473/753599
[INFO 04:13:23] my_main Recent Stats | t_env:     753599 | Episode:    15950
advantage_mean:           -0.3627	agent_grad_norm:           0.4888	critic_grad_norm:         17.8361	critic_loss:               4.3162
ep_length_mean:           45.8711	kickstart_coef:            2.8155	kickstart_loss:           -0.2469	pg_loss:                   0.3551
pi_max:                    0.8675	q_taken_mean:             -1.3495	return_mean:               0.4104	return_std:                0.3586
target_mean:              -1.7122	td_error_abs:              1.2516	test_ep_length_mean:      45.7580	test_return_mean:          0.4312
test_return_std:           0.3561	
[INFO 04:40:51] my_main t_env: 803669 / 1000000
[INFO 04:40:51] my_main Estimated time left: 1 hours, 48 minutes, 5 seconds. Time passed: 10 hours, 16 minutes, 31 seconds
[INFO 04:40:57] my_main Saving models to results/models/mappo_llm_seed251788030_LevelBasedForaging-v3_2024-09-20 18:24:17.123473/803669
[INFO 04:40:57] my_main Recent Stats | t_env:     803669 | Episode:    17070
advantage_mean:           -0.3928	agent_grad_norm:           0.8708	critic_grad_norm:         27.2685	critic_loss:               7.3046
ep_length_mean:           45.1324	kickstart_coef:            2.3081	kickstart_loss:           -0.2554	pg_loss:                   0.3819
pi_max:                    0.9451	q_taken_mean:             -1.0984	return_mean:               0.4566	return_std:                0.3799
target_mean:              -1.4912	td_error_abs:              1.7497	test_ep_length_mean:      44.9920	test_return_mean:          0.4506
test_return_std:           0.3713	
[INFO 05:16:59] my_main t_env: 853896 / 1000000
[INFO 05:16:59] my_main Estimated time left: 1 hours, 45 minutes, 4 seconds. Time passed: 10 hours, 52 minutes, 39 seconds
[INFO 05:17:04] my_main Saving models to results/models/mappo_llm_seed251788030_LevelBasedForaging-v3_2024-09-20 18:24:17.123473/853896
[INFO 05:17:04] my_main Recent Stats | t_env:     853896 | Episode:    18220
advantage_mean:            0.2445	agent_grad_norm:           0.9999	critic_grad_norm:         20.1618	critic_loss:               8.7413
ep_length_mean:           43.6505	kickstart_coef:            1.8024	kickstart_loss:           -0.2557	pg_loss:                  -0.2573
pi_max:                    0.9396	q_taken_mean:             -0.4253	return_mean:               0.5065	return_std:                0.3905
target_mean:              -0.1808	td_error_abs:              1.8800	test_ep_length_mean:      44.4380	test_return_mean:          0.4835
test_return_std:           0.3817	
[INFO 05:44:11] my_main t_env: 904231 / 1000000
[INFO 05:44:11] my_main Estimated time left: 51 minutes, 45 seconds. Time passed: 11 hours, 19 minutes, 51 seconds
[INFO 05:44:17] my_main Saving models to results/models/mappo_llm_seed251788030_LevelBasedForaging-v3_2024-09-20 18:24:17.123473/904231
[INFO 05:44:17] my_main Recent Stats | t_env:     904231 | Episode:    19390
advantage_mean:            0.1538	agent_grad_norm:           1.7116	critic_grad_norm:         16.5104	critic_loss:               8.8284
ep_length_mean:           43.0417	kickstart_coef:            1.2939	kickstart_loss:           -0.2543	pg_loss:                  -0.1454
pi_max:                    0.9478	q_taken_mean:             -0.2147	return_mean:               0.5603	return_std:                0.3912
target_mean:              -0.0609	td_error_abs:              1.9226	test_ep_length_mean:      43.6000	test_return_mean:          0.5131
test_return_std:           0.3891	
[INFO 06:20:57] my_main t_env: 954499 / 1000000
[INFO 06:20:57] my_main Estimated time left: 33 minutes, 17 seconds. Time passed: 11 hours, 56 minutes, 37 seconds
[INFO 06:21:03] my_main Saving models to results/models/mappo_llm_seed251788030_LevelBasedForaging-v3_2024-09-20 18:24:17.123473/954499
[INFO 06:21:03] my_main Recent Stats | t_env:     954499 | Episode:    20560
advantage_mean:           -0.0922	agent_grad_norm:           0.8800	critic_grad_norm:         19.6428	critic_loss:               7.9088
ep_length_mean:           43.1629	kickstart_coef:            0.7852	kickstart_loss:           -0.2691	pg_loss:                   0.0847
pi_max:                    0.9555	q_taken_mean:             -1.0957	return_mean:               0.5682	return_std:                0.3930
target_mean:              -1.1879	td_error_abs:              1.8136	test_ep_length_mean:      42.5580	test_return_mean:          0.5428
test_return_std:           0.4003	
[INFO 06:50:40] my_main Finished Training
Process Process-4:
Process Process-8:
Process Process-3:
Process Process-7:
Process Process-6:
Process Process-11:
Process Process-9:
Process Process-10:
Process Process-5:
Process Process-2:
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/wangyida/Repos/epymarl/src/runners/parallel_runner.py", line 371, in env_worker
    teacher.close()
  File "/home/wangyida/Repos/epymarl/src/teachers/teacher.py", line 37, in close
    self.planner.close()
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 71, in close
    self.cache.sync()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 103, in sync
    storage.update(self.cache)
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/wangyida/Repos/epymarl/src/runners/parallel_runner.py", line 371, in env_worker
    teacher.close()
  File "<string>", line 2, in keys
  File "/home/wangyida/Repos/epymarl/src/teachers/teacher.py", line 37, in close
    self.planner.close()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
    kind, result = conn.recv()
                   ^^^^^^^^^^^
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 71, in close
    self.cache.sync()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
          ^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 103, in sync
    storage.update(self.cache)
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
    buf = self._recv(4)
          ^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
    chunk = read(handle, remaining)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in keys
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
    kind, result = conn.recv()
                   ^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
          ^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
    buf = self._recv(4)
          ^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
    chunk = read(handle, remaining)
            ^^^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [Errno 104] Connection reset by peer
ConnectionResetError: [Errno 104] Connection reset by peer
Traceback (most recent call last):
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/wangyida/Repos/epymarl/src/runners/parallel_runner.py", line 371, in env_worker
    teacher.close()
  File "/home/wangyida/Repos/epymarl/src/teachers/teacher.py", line 37, in close
    self.planner.close()
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 71, in close
    self.cache.sync()
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 103, in sync
    storage.update(self.cache)
  File "<string>", line 2, in keys
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
    kind, result = conn.recv()
                   ^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
          ^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
    buf = self._recv(4)
          ^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
    chunk = read(handle, remaining)
            ^^^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [Errno 104] Connection reset by peer
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/wangyida/Repos/epymarl/src/runners/parallel_runner.py", line 371, in env_worker
    teacher.close()
  File "/home/wangyida/Repos/epymarl/src/teachers/teacher.py", line 37, in close
    self.planner.close()
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 71, in close
    self.cache.sync()
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 103, in sync
    storage.update(self.cache)
Traceback (most recent call last):
  File "<string>", line 2, in keys
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
    kind, result = conn.recv()
                   ^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
          ^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
    buf = self._recv(4)
          ^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
    chunk = read(handle, remaining)
            ^^^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [Errno 104] Connection reset by peer
Traceback (most recent call last):
Traceback (most recent call last):
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/wangyida/Repos/epymarl/src/runners/parallel_runner.py", line 371, in env_worker
    teacher.close()
  File "/home/wangyida/Repos/epymarl/src/teachers/teacher.py", line 37, in close
    self.planner.close()
Traceback (most recent call last):
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 71, in close
    self.cache.sync()
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 103, in sync
    storage.update(self.cache)
  File "<string>", line 2, in keys
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
    kind, result = conn.recv()
                   ^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
          ^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
    buf = self._recv(4)
          ^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 399, in _recv
    raise EOFError
Traceback (most recent call last):
EOFError
Exiting Main
Stopping all threads
Thread Thread-1 is alive! Is daemon: False
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/wangyida/Repos/epymarl/src/runners/parallel_runner.py", line 371, in env_worker
    teacher.close()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/wangyida/Repos/epymarl/src/teachers/teacher.py", line 37, in close
    self.planner.close()
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 71, in close
    self.cache.sync()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 103, in sync
    storage.update(self.cache)
  File "/home/wangyida/Repos/epymarl/src/runners/parallel_runner.py", line 371, in env_worker
    teacher.close()
  File "/home/wangyida/Repos/epymarl/src/teachers/teacher.py", line 37, in close
    self.planner.close()
  File "<string>", line 2, in keys
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 71, in close
    self.cache.sync()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
    kind, result = conn.recv()
                   ^^^^^^^^^^^
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 103, in sync
    storage.update(self.cache)
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
          ^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
    buf = self._recv(4)
          ^^^^^^^^^^^^^
  File "<string>", line 2, in keys
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
    chunk = read(handle, remaining)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
    kind, result = conn.recv()
                   ^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
          ^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
    buf = self._recv(4)
          ^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
    chunk = read(handle, remaining)
            ^^^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [Errno 104] Connection reset by peer
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/wangyida/Repos/epymarl/src/runners/parallel_runner.py", line 371, in env_worker
    teacher.close()
ConnectionResetError: [Errno 104] Connection reset by peer
  File "/home/wangyida/Repos/epymarl/src/teachers/teacher.py", line 37, in close
    self.planner.close()
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 71, in close
    self.cache.sync()
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 103, in sync
    storage.update(self.cache)
  File "<string>", line 2, in keys
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
    kind, result = conn.recv()
                   ^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
          ^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
    buf = self._recv(4)
          ^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
    chunk = read(handle, remaining)
            ^^^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [Errno 104] Connection reset by peer
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
  File "/home/wangyida/Repos/epymarl/src/runners/parallel_runner.py", line 371, in env_worker
    teacher.close()
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/wangyida/Repos/epymarl/src/teachers/teacher.py", line 37, in close
    self.planner.close()
  File "/home/wangyida/Repos/epymarl/src/runners/parallel_runner.py", line 371, in env_worker
    teacher.close()
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 71, in close
    self.cache.sync()
  File "/home/wangyida/Repos/epymarl/src/teachers/teacher.py", line 37, in close
    self.planner.close()
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 103, in sync
    storage.update(self.cache)
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 71, in close
    self.cache.sync()
  File "/home/wangyida/Repos/epymarl/src/teachers/planners/planner.py", line 103, in sync
    storage.update(self.cache)
  File "<string>", line 2, in keys
  File "<string>", line 2, in keys
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
    kind, result = conn.recv()
                   ^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
    kind, result = conn.recv()
                   ^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
          ^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
          ^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
    buf = self._recv(4)
          ^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
    buf = self._recv(4)
          ^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
    chunk = read(handle, remaining)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/wangyida/.pyenv/versions/3.11.10/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
    chunk = read(handle, remaining)
            ^^^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [Errno 104] Connection reset by peer
ConnectionResetError: [Errno 104] Connection reset by peer
Thread joined
Exiting script
[DEBUG 06:50:42] my_main Finished after 12:26:25.
[INFO 06:50:42] pymarl Completed after 12:26:25
